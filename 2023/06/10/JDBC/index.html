<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="MinGe">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/2023/06/10/jdbc/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="一、JDBC入门1.1 什么是JDBCJava Database Connectivity，简称JDBC；是Java语言中用来规范客户端程序如何来访问数据库的应用程序接口，提供了诸如查询和更新数据库中数据的方法。JDBC也是Sun Microsystems的商标。我们通常说的JDBC是面向关系型数据库的。 1.2 使用JDBC的好处： JDBC API是一组接口，没有具体的实现。实现类由各数据库厂">
<meta property="og:type" content="article">
<meta property="og:title" content="JDBC">
<meta property="og:url" content="http://example.com/2023/06/10/JDBC/index.html">
<meta property="og:site_name" content="MinGe">
<meta property="og:description" content="一、JDBC入门1.1 什么是JDBCJava Database Connectivity，简称JDBC；是Java语言中用来规范客户端程序如何来访问数据库的应用程序接口，提供了诸如查询和更新数据库中数据的方法。JDBC也是Sun Microsystems的商标。我们通常说的JDBC是面向关系型数据库的。 1.2 使用JDBC的好处： JDBC API是一组接口，没有具体的实现。实现类由各数据库厂">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/JDBC/100.png">
<meta property="og:image" content="http://example.com/images/JDBC/99.png">
<meta property="og:image" content="http://example.com/images/JDBC/97.png">
<meta property="og:image" content="http://example.com/images/JDBC/98.png">
<meta property="og:image" content="http://example.com/images/JDBC/96.png">
<meta property="og:image" content="http://example.com/images/JDBC/95.png">
<meta property="og:image" content="http://example.com/images/JDBC/94.png">
<meta property="og:image" content="http://example.com/images/JDBC/93.png">
<meta property="og:image" content="http://example.com/images/JDBC/92.png">
<meta property="og:image" content="http://example.com/images/JDBC/91.png">
<meta property="og:image" content="http://example.com/images/JDBC/90.png">
<meta property="article:published_time" content="2023-06-10T01:11:00.000Z">
<meta property="article:modified_time" content="2024-11-11T08:23:43.305Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="java">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/JDBC/100.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/redefine-favicon.svg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/redefine-favicon.svg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/redefine-favicon.svg">
    <!--- Page Info-->
    
    <title>
        
            JDBC -
        
        MinGe 博客
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"example.com","root":"/","language":"en"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":1,"number":false,"expand":false,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"dark"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":false,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"MinGe 博客","subtitle":{"text":[],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.7.1","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"resume":{"path":"/2024/11/02/简历/","icon":"fa-regular fa-folder"}},"search":{"enable":false,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":{"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2022/09/25 08:00:00"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
<!--        <span class="swup-progress-icon">-->
<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
<!--        </span>-->
    
</div>



<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container px-6 md:px-12">

    <div class="navbar-content ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                MinGe 博客
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/2024/11/02/%E7%AE%80%E5%8E%86/"
                                        >
                                    <i class="fa-regular fa-folder fa-fw"></i>
                                    RESUME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-screen w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/2024/11/02/%E7%AE%80%E5%8E%86/"
                        >
                            <span>
                                RESUME
                            </span>
                            
                                <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/archives"
                        >
                            <span>Archives</span>
                            <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/tags"
                        >
                            <span>Tags</span>
                            <i class="fa-regular fa-tags fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/categories"
                        >
                            <span>Categories</span>
                            <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                        </a>
                    </li>
                
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">3</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">2</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">20</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container flex relative justify-between box-border w-full h-full">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                <div class="w-full flex items-center pt-6 justify-start">
                    <h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">JDBC</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="/images/redefine-avatar.svg">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">MinGe</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv3</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2023-06-10 09:11</span>
        <span class="mobile">2023-06-10 09:11</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-11-11 16:23:43</span>
            <span class="mobile">2024-11-11 16:23:43</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/java/">java</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h1 id="一、JDBC入门"><a href="#一、JDBC入门" class="headerlink" title="一、JDBC入门"></a>一、JDBC入门</h1><h2 id="1-1-什么是JDBC"><a href="#1-1-什么是JDBC" class="headerlink" title="1.1 什么是JDBC"></a>1.1 什么是JDBC</h2><p>Java Database Connectivity，简称JDBC；是Java语言中用来规范客户端程序如何来访问数据库的应用程序<strong>接口</strong>，提供了诸如查询和更新数据库中数据的方法。JDBC也是Sun Microsystems的商标。我们通常说的JDBC是面向关系型数据库的。</p>
<h2 id="1-2-使用JDBC的好处："><a href="#1-2-使用JDBC的好处：" class="headerlink" title="1.2 使用JDBC的好处："></a>1.2 使用JDBC的好处：</h2><ol>
<li>JDBC API是一组接口，没有具体的实现。实现类由各数据库厂商去实现。我们只需要调用接口中的方法即可。</li>
<li>我们的JDBC代码只需要少量的修改就可以访问另一种数据库。</li>
<li>以后我们学习的所有数据库框架，底层最终都会转成JDBC的代码来实现。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/JDBC/100.png"
                     
                ></p>
<h2 id="1-3-JDBC开发使用到的包："><a href="#1-3-JDBC开发使用到的包：" class="headerlink" title="1.3 JDBC开发使用到的包："></a>1.3 JDBC开发使用到的包：</h2><table>
<thead>
<tr>
<th>会使用到的包</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>java.sql</td>
<td>今天要学习的包，所有的接口和类都在这个包中</td>
</tr>
<tr>
<td>javax.sql</td>
<td>数据库访问的高级内容，如：连接池</td>
</tr>
<tr>
<td>数据库的驱动</td>
<td>如：mysql的驱动 com.mysql.jdbc.Driver</td>
</tr>
</tbody></table>
<h2 id="1-4-导入驱动Jar包"><a href="#1-4-导入驱动Jar包" class="headerlink" title="1.4 导入驱动Jar包"></a>1.4 导入驱动Jar包</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/JDBC/99.png"
                     
                ></p>
<h2 id="1-5-JDBC的核心API"><a href="#1-5-JDBC的核心API" class="headerlink" title="1.5 JDBC的核心API"></a>1.5 JDBC的核心API</h2><table>
<thead>
<tr>
<th>接口或类</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>DriverManager类</td>
<td>1. 加载和注册第三方厂商的驱动程序 2. 创建一个数据库的连接对象</td>
</tr>
<tr>
<td>Connection接口</td>
<td>代表一个创建好的连接对象</td>
</tr>
<tr>
<td>Statement接口</td>
<td>代表一条要发送给服务器的SQL语句对象</td>
</tr>
<tr>
<td>PreparedStatement接口</td>
<td>代表一条要发送给服务器的SQL语句对象，是Statement接口的子接口</td>
</tr>
<tr>
<td>ResultSet接口</td>
<td>代表从服务器上返回的查询结果集</td>
</tr>
</tbody></table>
<h2 id="1-6-类中的方法："><a href="#1-6-类中的方法：" class="headerlink" title="1.6 类中的方法："></a>1.6 类中的方法：</h2><table>
<thead>
<tr>
<th>DriverManager类中的静态方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Connection getConnection (String url, String user, String password)</td>
<td>得到一个连接对象 url: 连接字符串 user: 用户名 password: 密码</td>
</tr>
<tr>
<td>Connection getConnection (String url, Properties info)</td>
<td>得到一个连接对象 url: 连接字符串 info: 属性集合对象，封装了所有的数据库连接参数</td>
</tr>
</tbody></table>
<h2 id="1-7-使用JDBC连接数据库的四个参数："><a href="#1-7-使用JDBC连接数据库的四个参数：" class="headerlink" title="1.7 使用JDBC连接数据库的四个参数："></a>1.7 使用JDBC连接数据库的四个参数：</h2><table>
<thead>
<tr>
<th>JDBC连接数据库的四个参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>用户名</td>
<td>root</td>
</tr>
<tr>
<td>密码</td>
<td>root</td>
</tr>
<tr>
<td>URL连接字符串</td>
<td>指定客户端与服务器连接的参数</td>
</tr>
<tr>
<td>驱动名</td>
<td>com.mysql.jdbc.Driver</td>
</tr>
</tbody></table>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/JDBC/97.png"
                     
                ></p>
<p>MySQL中简写：<code>jdbc:mysql:///test</code>（服务器必须是localhost，端口号必须是3306）</p>
<h3 id="1-7-1-乱码的处理"><a href="#1-7-1-乱码的处理" class="headerlink" title="1.7.1 乱码的处理"></a>1.7.1 乱码的处理</h3><p>如果数据库出现乱码，可以指定参数：<code>?characterEncoding=utf8</code>，表示让数据库以UTF-8编码来处理数据。</p>
<div class="highlight-container" data-rel="Properties"><figure class="iseeu highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jdbc</span>:<span class="string">mysql://localhost:3306/test?characterEncoding=utf8&amp;serverTimezone=GMT%2b8</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li><p><code>characterEncoding</code>：JDBC连接使用的编码</p>
</li>
<li><p><code>serverTimezone</code>：JDBC连接使用的时区</p>
</li>
</ul>
</blockquote>
<h2 id="1-8-案例：得到MySQL的数据库连接对象"><a href="#1-8-案例：得到MySQL的数据库连接对象" class="headerlink" title="1.8 案例：得到MySQL的数据库连接对象"></a>1.8 案例：得到MySQL的数据库连接对象</h2><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 加载和注册驱动(jdbc4以后不需要)</span></span><br><span class="line">        <span class="comment">// Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//使用用户名、密码、URL得到连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">c1</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/db04&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        System.out.println(c1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建属性对象</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="comment">//设置用户名和密码</span></span><br><span class="line">        info.setProperty(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        info.setProperty(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//使用属性对象和url得到连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">c2</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql:///db04&quot;</span>, info);</span><br><span class="line">        System.out.println(c2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/JDBC/98.png"
                     
                ></p>
<h1 id="二、Connection接口："><a href="#二、Connection接口：" class="headerlink" title="二、Connection接口："></a>二、Connection接口：</h1><p>Connection：代表一个客户端与服务器端之间创建的一个连接对象，通过连接对象可以创建SQL语句对象Statement和PreparedStatement对象</p>
<h2 id="2-1-Connection方法："><a href="#2-1-Connection方法：" class="headerlink" title="2.1 Connection方法："></a>2.1 Connection方法：</h2><table>
<thead>
<tr>
<th>Connection接口中的方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Statement createStatement()</td>
<td>通过连接对象创建SQL语句对象</td>
</tr>
</tbody></table>
<ul>
<li>创建一个语句对象</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo02</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        <span class="comment">// 创建连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/db04&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        <span class="comment">// 通过连接对象得到语句对象</span></span><br><span class="line">        <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">        System.out.println(<span class="string">&quot;语句对象：&quot;</span> + stmt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="三、Statement接口"><a href="#三、Statement接口" class="headerlink" title="三、Statement接口"></a>三、Statement接口</h1><p>Statement：代表一个SQL语句对象，需要将它发送给服务器去执行。</p>
<h2 id="3-1-Statement中的方法："><a href="#3-1-Statement中的方法：" class="headerlink" title="3.1 Statement中的方法："></a>3.1 Statement中的方法：</h2><table>
<thead>
<tr>
<th>Statement接口中的方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>boolean execute(String sql)</td>
<td>作用：可以执行任何的SQL语句 返回值：如果SQL语句执行后有结果集，返回true，如果没有，返回false</td>
</tr>
<tr>
<td>int executeUpdate(String sql)</td>
<td>作用：用于执行DML语句，增删改：insert, update, delete 返回值：影响的行数</td>
</tr>
<tr>
<td>ResultSet executeQuery(String sql)</td>
<td>作用：用于DQL语句，查询select 返回值：查询到的结果集</td>
</tr>
</tbody></table>
<h2 id="3-2-释放资源"><a href="#3-2-释放资源" class="headerlink" title="3.2 释放资源"></a>3.2 释放资源</h2><ol>
<li><p>释放的对象：结果集ResultSet，语句对象Statement，连接对象Connection</p>
</li>
<li><p>释放顺序：先开的后关，后开先关。ResultSet -&gt; Statement -&gt; Connection对象</p>
</li>
<li><p>放在哪里: finally，无论有没有异常，都必须关闭。</p>
</li>
</ol>
<ul>
<li>疑问：什么样的代码可以放在try()中？</li>
</ul>
<p>放在try()中的类必须实现AutoClosable接口，才可以自动关闭。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Connection</span> <span class="keyword">extends</span> <span class="title class_">Wrapper</span>, AutoCloseable</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Statement</span> <span class="keyword">extends</span> <span class="title class_">Wrapper</span>, AutoCloseable</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ResultSet</span> <span class="keyword">extends</span> <span class="title class_">Wrapper</span>, AutoCloseable</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h2 id="3-3-执行DDL操作"><a href="#3-3-执行DDL操作" class="headerlink" title="3.3 执行DDL操作"></a>3.3 执行DDL操作</h2><ul>
<li>需求：使用JDBC在MySQL的数据库中创建一张学生表</li>
</ul>
<ol>
<li><p>id是主键，整数类型，自增长</p>
</li>
<li><p>name是varchar(20)，非空</p>
</li>
<li><p>性别是boolean类型，在mysql中使用的tinyint微整型(0假 1真)</p>
</li>
<li><p>生日是date类型</p>
</li>
</ol>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student (</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">PRIMARY</span> KEY auto_increment,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    gender <span class="type">char</span>(<span class="number">1</span>),</span><br><span class="line">    birthday <span class="type">date</span>,</span><br><span class="line">    address <span class="type">varchar</span>(<span class="number">30</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></div>

<ul>
<li>代码：</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dfbz.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo3</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 使用JDBC创建表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//创建连接对象</span></span><br><span class="line">            conn = DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/db04&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">            <span class="comment">//通过连接对象得到语句对象</span></span><br><span class="line">            stmt = conn.createStatement();</span><br><span class="line">            <span class="comment">//执行SQL语句，运行DDL代码</span></span><br><span class="line">            <span class="comment">//SQL语句建表代码</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;CREATE TABLE student (\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    id int PRIMARY KEY auto_increment,\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    name VARCHAR(20) not null,\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    gender char(1),\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    birthday date,\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    address varchar(30)\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;);&quot;</span>;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> stmt.execute(sql);</span><br><span class="line">            System.out.println(b);   <span class="comment">//false 没有结果集</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">//释放资源</span></span><br><span class="line">            <span class="keyword">if</span> (stmt != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    stmt.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//连接对象关闭</span></span><br><span class="line">            <span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    conn.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>使用try()方式释放连接对象</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * try()方式释放异常</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> (</span><br><span class="line">            <span class="comment">//1. 创建连接对象</span></span><br><span class="line">            <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/db04&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//2. 通过连接对象得到语句对象</span></span><br><span class="line">            <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">    ) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行SQL语句，运行DDL代码</span></span><br><span class="line">        <span class="comment">//SQL语句建表代码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;CREATE TABLE student (\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    id int PRIMARY KEY auto_increment,\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    name VARCHAR(20) not null,\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    gender char(1),\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    birthday date,\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    address varchar(30)\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;);&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> stmt.execute(sql);</span><br><span class="line"></span><br><span class="line">        System.out.println(b);   <span class="comment">//false 没有结果集</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="3-4-执行DML操作"><a href="#3-4-执行DML操作" class="headerlink" title="3.4 执行DML操作"></a>3.4 执行DML操作</h2><ul>
<li>需求：向学生表中添加4条记录，主键是自动增长</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test3</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> (</span><br><span class="line">            <span class="comment">//创建连接对象</span></span><br><span class="line">            <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql:///db04&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">            <span class="comment">//创建语句对象</span></span><br><span class="line">            <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        insert into student values</span></span><br><span class="line"><span class="comment">        (null,&#x27;小明&#x27;,&#x27;男&#x27;,&#x27;2000-10-20&#x27;,&#x27;湖南永州&#x27;),</span></span><br><span class="line"><span class="comment">        (null,&#x27;小红&#x27;,&#x27;女&#x27;,&#x27;1998-08-24&#x27;,&#x27;福建南平&#x27;),</span></span><br><span class="line"><span class="comment">        (null,&#x27;小军&#x27;,&#x27;男&#x27;,&#x27;1997-06-18&#x27;,&#x27;四川泸州&#x27;),</span></span><br><span class="line"><span class="comment">        (null,&#x27;小聪&#x27;,&#x27;男&#x27;,&#x27;2001-10-21&#x27;,&#x27;贵州遵义&#x27;);</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        String sql=<span class="string">&quot;insert into student values\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;(null,&#x27;小明&#x27;,&#x27;男&#x27;,&#x27;2000-10-20&#x27;,&#x27;湖南永州&#x27;),\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;(null,&#x27;小红&#x27;,&#x27;女&#x27;,&#x27;1998-08-24&#x27;,&#x27;福建南平&#x27;),\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;(null,&#x27;小军&#x27;,&#x27;男&#x27;,&#x27;1997-06-18&#x27;,&#x27;四川泸州&#x27;),\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;(null,&#x27;小聪&#x27;,&#x27;男&#x27;,&#x27;2001-10-21&#x27;,&#x27;贵州遵义&#x27;);&quot;</span>;</span><br><span class="line">        <span class="comment">//执行SQL语句</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> stmt.executeUpdate(sql);</span><br><span class="line">        System.out.println(<span class="string">&quot;影响的行数：&quot;</span> + row);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>需求：修改id为1的学生</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  修改记录</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test4</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="comment">//创建连接对象</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/db04&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//得到语句对象</span></span><br><span class="line">    <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update student set name=&#x27;明明&#x27;, gender=&#x27;女&#x27;, birthday=&#x27;1999-05-14&#x27;, address=&#x27;山东菏泽&#x27; where id=1&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//执行SQL语句</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> stmt.executeUpdate(sql);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;影响的行数: &quot;</span> + row);</span><br><span class="line">    <span class="comment">//释放资源</span></span><br><span class="line">    stmt.close();</span><br><span class="line">    conn.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>需求：删除id为2的学生</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  删除记录</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test5</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="comment">//创建连接对象</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/db04&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//得到语句对象</span></span><br><span class="line">    <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from student where id=2&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//执行SQL语句</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> stmt.executeUpdate(sql);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;影响的行数: &quot;</span> + row);</span><br><span class="line">    <span class="comment">//释放资源</span></span><br><span class="line">    stmt.close();</span><br><span class="line">    conn.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="3-5-执行DQL操作"><a href="#3-5-执行DQL操作" class="headerlink" title="3.5 执行DQL操作"></a>3.5 执行DQL操作</h2><h3 id="3-5-1-ResultSet接口："><a href="#3-5-1-ResultSet接口：" class="headerlink" title="3.5.1 ResultSet接口："></a>3.5.1 ResultSet接口：</h3><p>作用：封装从数据库服务器中查询到的所有记录。从结果集对象中得到查询的数据</p>
<ul>
<li><p>原理：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/JDBC/96.png"
                     
                ></p>
</li>
<li><p>接口中的方法：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>ResultSet接口中的方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>boolean next()</td>
<td>1) 向下移动一行 <br/>2) 判断当前所指的是否是记录，如果是记录则返回true，如果是最后一行的后面，则返回false</td>
</tr>
<tr>
<td>数据类型 getXxx(参数)</td>
<td>得到每一列的数据 <br>1) 通过列名来取 <br>2) 通过列号来取 注：数据库中的数据类型如果可以自动转换，可以使用其它的java类型来取值。 如：数据库中是int，可以按String来取</td>
</tr>
</tbody></table>
<h3 id="3-5-2-常用数据类型转换表"><a href="#3-5-2-常用数据类型转换表" class="headerlink" title="3.5.2 常用数据类型转换表"></a>3.5.2 常用数据类型转换表</h3><table>
<thead>
<tr>
<th>SQL类型</th>
<th>Jdbc对应方法</th>
<th>返回类型</th>
</tr>
</thead>
<tbody><tr>
<td>BIT(1) bit(n)</td>
<td><strong>getBoolean()</strong></td>
<td><strong>boolean</strong></td>
</tr>
<tr>
<td>TINYINT</td>
<td><strong>getByte()</strong></td>
<td><strong>byte</strong></td>
</tr>
<tr>
<td>SMALLINT</td>
<td><strong>getShort()</strong></td>
<td><strong>short</strong></td>
</tr>
<tr>
<td>INT</td>
<td><strong>getInt()</strong></td>
<td><strong>int</strong></td>
</tr>
<tr>
<td>BIGINT</td>
<td><strong>getLong()</strong></td>
<td><strong>long</strong></td>
</tr>
<tr>
<td>CHAR,VARCHAR</td>
<td><strong>getString()</strong></td>
<td><strong>String</strong></td>
</tr>
<tr>
<td>DATE</td>
<td><strong>getDate()</strong></td>
<td><strong>java.sql.Date 只表示日期</strong></td>
</tr>
<tr>
<td>TIME</td>
<td><strong>getTime()</strong></td>
<td><strong>java.sql.Time 只表示时间</strong></td>
</tr>
<tr>
<td>TIMESTAMP,DateTime</td>
<td><strong>getTimestamp()</strong></td>
<td><strong>java.sql.Timestamp 同时有日期和时间</strong></td>
</tr>
</tbody></table>
<h3 id="3-5-3-日期和时间相关的三个方法说明"><a href="#3-5-3-日期和时间相关的三个方法说明" class="headerlink" title="3.5.3 日期和时间相关的三个方法说明"></a>3.5.3 日期和时间相关的三个方法说明</h3><ul>
<li><p>日期：java.sql.Date</p>
</li>
<li><p>时间：java.sql.Time</p>
</li>
<li><p>时间戳：java.sql.Timestamp</p>
</li>
<li><p>共同父类：java.util.Date</p>
</li>
</ul>
<p>需求：确保数据库中有3条以上的记录，查询所有的学员信息</p>
<ul>
<li>代码</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dfbz.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo04_DQL</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//创建连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql:///db04&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建语句对象</span></span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行SQL语句，返回结果集</span></span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(<span class="string">&quot;select * from student&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//遍历结果集</span></span><br><span class="line">        <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">            <span class="comment">//通过列名来取</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            int id = rs.getInt(&quot;id&quot;);</span></span><br><span class="line"><span class="comment">            String name = rs.getString(&quot;name&quot;);</span></span><br><span class="line"><span class="comment">            String gender = rs.getString(&quot;gender&quot;);</span></span><br><span class="line"><span class="comment">            Date Date = rs.getBoolean(&quot;birthday&quot;);</span></span><br><span class="line"><span class="comment">            String address = rs.getString(&quot;address&quot;);</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//通过列号来取</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="number">1</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="number">2</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">gender</span> <span class="operator">=</span> rs.getString(<span class="number">3</span>);</span><br><span class="line">            <span class="type">Date</span> <span class="variable">birthday</span> <span class="operator">=</span> rs.getDate(<span class="number">4</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">address</span> <span class="operator">=</span> rs.getString(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;id: &quot;</span> + id);</span><br><span class="line">            System.out.println(<span class="string">&quot;name: &quot;</span> + name);</span><br><span class="line">            System.out.println(<span class="string">&quot;gender: &quot;</span> + gender);</span><br><span class="line">            System.out.println(<span class="string">&quot;birthday: &quot;</span> + birthday);</span><br><span class="line">            System.out.println(<span class="string">&quot;address: &quot;</span> + address);</span><br><span class="line">            System.out.println(<span class="string">&quot;-----------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//释放资源</span></span><br><span class="line">        rs.close();</span><br><span class="line">        statement.close();</span><br><span class="line">        conn.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="3-6-关于ResultSet接口中的注意事项："><a href="#3-6-关于ResultSet接口中的注意事项：" class="headerlink" title="3.6 关于ResultSet接口中的注意事项："></a>3.6 关于ResultSet接口中的注意事项：</h2><ol>
<li><p>如果光标在第一行之前，使用rs.getXX()获取列值，报错：Before start of resultset</p>
</li>
<li><p>如果光标在最后一行之后，使用rs.getXX()获取列值，报错：After end of resultset</p>
</li>
</ol>
<h1 id="四、数据库工具类JdbcUtils"><a href="#四、数据库工具类JdbcUtils" class="headerlink" title="四、数据库工具类JdbcUtils"></a>四、数据库工具类JdbcUtils</h1><p>如果某些代码可重用性很强，没有什么变化。可以将它们抽取出来写成一个工具类调用。</p>
<h2 id="4-1-创建工具类"><a href="#4-1-创建工具类" class="headerlink" title="4.1 创建工具类"></a>4.1 创建工具类</h2><ul>
<li><p>需求：上面的代码中出现了很多重复的代码，可以把这些公共代码抽取出来。</p>
</li>
<li><p>创建类JdbcUtil包含3个方法：</p>
</li>
</ul>
<ol>
<li>把几个字符串定义成常量：用户名，密码，URL，驱动类</li>
<li>注册驱动，为了兼容以前的程序</li>
<li>得到数据库的连接：getConnection()</li>
<li>关闭所有打开的资源：<br>close(Connection conn, Statement stmt)，<br>close(Connection conn, Statement stmt, ResultSet rs)</li>
</ol>
<ul>
<li>代码</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dfbz.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>:创建一个工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义四个常量：用户名，密码，URL，驱动名</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USER</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PASSWORD</span> <span class="operator">=</span> <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">URL</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql:///db04&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DRIVER</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到连接对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> DriverManager.getConnection(URL, USER, PASSWORD);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 写一个关闭的方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Connection conn, Statement stmt, ResultSet rs)</span> &#123;</span><br><span class="line">        <span class="comment">//关闭结果集</span></span><br><span class="line">        <span class="keyword">if</span> (rs!=<span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭语句对象</span></span><br><span class="line">        <span class="keyword">if</span> (stmt!=<span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                stmt.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭连接对象</span></span><br><span class="line">        <span class="keyword">if</span> (conn!=<span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭连接</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Connection conn, Statement stmt)</span> &#123;</span><br><span class="line">        close(conn, stmt, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="4-2-案例：用户登陆"><a href="#4-2-案例：用户登陆" class="headerlink" title="4.2 案例：用户登陆"></a>4.2 案例：用户登陆</h2><p>需求：有一张用户表，添加几条用户记录</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> `<span class="keyword">user</span>`(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">`name` <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">`password` <span class="type">varchar</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span> <span class="keyword">values</span>(<span class="keyword">null</span>, <span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;123&#x27;</span>),(<span class="keyword">null</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;456&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 登录成功</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;admin&#x27;</span> <span class="keyword">and</span> password<span class="operator">=</span><span class="string">&#x27;123&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 登录失败</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;root&#x27;</span> <span class="keyword">and</span> password<span class="operator">=</span><span class="string">&#x27;999&#x27;</span></span><br></pre></td></tr></table></figure></div>

<ol>
<li>使用Statement字符串拼接的方式实现用户的登录，用户在控制台上输入用户名和密码。</li>
</ol>
<h3 id="4-2-1-开发步骤："><a href="#4-2-1-开发步骤：" class="headerlink" title="4.2.1 开发步骤："></a>4.2.1 开发步骤：</h3><ol>
<li><p>得到用户从控制台上输入的用户名和密码</p>
</li>
<li><p>调用下面写的登录方法来实现登录</p>
</li>
<li><p>写一个登录的方法</p>
<ol>
<li><p>通过工具类得到连接</p>
</li>
<li><p>创建语句对象，使用拼接字符串的方式生成SQL语句</p>
</li>
<li><p>查询数据库，如果有记录则表示登录成功，否则登录失败</p>
</li>
<li><p>释放资源</p>
</li>
</ol>
</li>
</ol>
<h3 id="4-2-2-代码："><a href="#4-2-2-代码：" class="headerlink" title="4.2.2 代码："></a>4.2.2 代码：</h3><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dfbz.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.dfbz.utils.JdbcUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo05_Login</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">//让用户输入用户名和密码</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入密码：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//访问数据库</span></span><br><span class="line">        <span class="comment">//得到连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JdbcUtils.getConnection();</span><br><span class="line">        <span class="comment">//创建语句对象</span></span><br><span class="line">        <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//执行DQL查询，通过字符串拼接的方式得到SQL语句</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from user where name=&#x27;&quot;</span> + name + <span class="string">&quot;&#x27; and password=&#x27;&quot;</span> + password + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">        <span class="comment">//得到结果集</span></span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> stmt.executeQuery(sql);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断是否有记录</span></span><br><span class="line">        <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;登录成功，&quot;</span> + name);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;登录失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//关闭资源</span></span><br><span class="line">        JdbcUtils.close(conn, stmt, rs);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="五、SQL注入问题"><a href="#五、SQL注入问题" class="headerlink" title="五、SQL注入问题"></a>五、SQL注入问题</h1><ul>
<li>当我们输入以下密码，我们发现我们账号和密码都不对竟然登录成功了</li>
</ul>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abc<span class="string">&#x27; or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/JDBC/95.png"
                     
                ></p>
<ul>
<li>问题分析：</li>
</ul>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;admin&#x27;</span> <span class="keyword">and</span> password<span class="operator">=</span><span class="string">&#x27;abc&#x27;</span> <span class="keyword">or</span> <span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="literal">false</span> <span class="keyword">and</span> <span class="literal">false</span> <span class="keyword">or</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="literal">false</span> <span class="keyword">or</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询所有的记录</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="literal">true</span>;</span><br></pre></td></tr></table></figure></div>

<p>我们让用户输入的密码和SQL语句进行字符串拼接。用户输入的内容作为了SQL语句语法的一部分，改变了原有SQL真正的意义，以上问题称为SQL注入。要解决SQL注入就不能让用户输入的密码和我们的SQL语句进行简单的字符串拼接。</p>
<h2 id="5-1-PreparedStatement概述"><a href="#5-1-PreparedStatement概述" class="headerlink" title="5.1 PreparedStatement概述"></a>5.1 PreparedStatement概述</h2><blockquote>
<p>如何解决SQL注入的问题，必须使用Statement它的子接口</p>
</blockquote>
<h2 id="5-2-PreparedStatement中相关的方法"><a href="#5-2-PreparedStatement中相关的方法" class="headerlink" title="5.2 PreparedStatement中相关的方法"></a>5.2 PreparedStatement中相关的方法</h2><h3 id="5-2-1-PreparedStatement接口中的方法："><a href="#5-2-1-PreparedStatement接口中的方法：" class="headerlink" title="5.2.1 PreparedStatement接口中的方法："></a>5.2.1 PreparedStatement接口中的方法：</h3><table>
<thead>
<tr>
<th>PreparedStatement接口中的方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>int executeUpdate()</td>
<td>执行DML，增删改的操作。注：没有参数。 SQL语句在创建PreparedStatement对象的时候就已经提供了，所以执行的时候没有SQL语句 返回：影响的行数</td>
</tr>
<tr>
<td>ResultSet executeQuery()</td>
<td>执行DQL，查询操作 返回：结果集</td>
</tr>
</tbody></table>
<h2 id="5-2-2-使用PreparedStatement"><a href="#5-2-2-使用PreparedStatement" class="headerlink" title="5.2.2 使用PreparedStatement"></a>5.2.2 使用PreparedStatement</h2><h3 id="5-2-2-1-开发步骤："><a href="#5-2-2-1-开发步骤：" class="headerlink" title="5.2.2.1 开发步骤："></a>5.2.2.1 开发步骤：</h3><ol>
<li>编写SQL语句，未知内容使用占位符</li>
<li>获得PreparedStatement对象</li>
<li>设置实际参数，使用set数据类型(占位符位置, 真实值)</li>
<li>执行参数化SQL语句</li>
<li>关闭资源</li>
</ol>
<h3 id="5-2-2-2-相应的方法"><a href="#5-2-2-2-相应的方法" class="headerlink" title="5.2.2.2 相应的方法"></a>5.2.2.2 相应的方法</h3><table>
<thead>
<tr>
<th>PreparedStatement的方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>void setXxx(int 参数1，参数2) Xxx数据类型</td>
<td>替换SQL语句中的占位符 参数1： 占位符的位置，第几个位置，从1开始 参数2： 用来替换占位符的真实的值</td>
</tr>
<tr>
<td>PreparedStatement中设置参数的方法</td>
<td>描述</td>
</tr>
<tr>
<td>void setDouble(int parameterIndex, double x)</td>
<td>将指定参数设置为给定 Java double 值。</td>
</tr>
<tr>
<td>void setFloat(int parameterIndex, float x)</td>
<td>将指定参数设置为给定 Java REAL 值。</td>
</tr>
<tr>
<td>void setInt(int parameterIndex, int x)</td>
<td>将指定参数设置为给定 Java int 值。</td>
</tr>
<tr>
<td>void setLong(int parameterIndex, long x)</td>
<td>将指定参数设置为给定 Java long 值。</td>
</tr>
<tr>
<td>void setObject(int parameterIndex, Object x)</td>
<td>使用给定对象设置指定参数的值。</td>
</tr>
<tr>
<td>void setString(int parameterIndex, String x)</td>
<td>将指定参数设置为给定 Java String 值。</td>
</tr>
</tbody></table>
<p>案例：使用PreparedStatement改写登录程序</p>
<ul>
<li>执行效果</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/JDBC/94.png"
                     
                ></p>
<ul>
<li>工具类</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dfbz.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义四个常量：用户名，密码，URL，驱动名</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USER</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PASSWORD</span> <span class="operator">=</span> <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">URL</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql:///db04&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DRIVER</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到连接对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> DriverManager.getConnection(URL, USER, PASSWORD);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 写一个关闭的方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Connection conn, Statement stmt, ResultSet rs)</span> &#123;</span><br><span class="line">        <span class="comment">//关闭结果集</span></span><br><span class="line">        <span class="keyword">if</span> (rs!=<span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭语句对象</span></span><br><span class="line">        <span class="keyword">if</span> (stmt!=<span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                stmt.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭连接对象</span></span><br><span class="line">        <span class="keyword">if</span> (conn!=<span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭连接</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Connection conn, Statement stmt)</span> &#123;</span><br><span class="line">        close(conn, stmt, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>代码</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dfbz.login;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.dfbz.utils.JdbcUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>: 使用PreparedStatement改写登录程序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginSystem2</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//让用户输入用户名和密码</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入密码：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//声明对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//访问数据库，创建连接</span></span><br><span class="line">            conn = JdbcUtils.getConnection();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//创建预编译的SQL语句</span></span><br><span class="line">            ps = conn.prepareStatement(<span class="string">&quot;select * from user where name=? and password=?&quot;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//替换占位符</span></span><br><span class="line">            ps.setString(<span class="number">1</span>, name);</span><br><span class="line">            ps.setString(<span class="number">2</span>, password);</span><br><span class="line">            <span class="comment">//执行SQL语句，查询</span></span><br><span class="line">            rs = ps.executeQuery();</span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;登录成功&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;登录失败&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;  <span class="comment">//ctrl+alt+t</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.close(conn, ps, rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h2 id="5-2-3-PreparedStatement执行DML操作"><a href="#5-2-3-PreparedStatement执行DML操作" class="headerlink" title="5.2.3 PreparedStatement执行DML操作"></a>5.2.3 PreparedStatement执行DML操作</h2><div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 清空表</span></span><br><span class="line"><span class="keyword">truncate</span> student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student <span class="keyword">values</span></span><br><span class="line">(<span class="keyword">null</span>,<span class="string">&#x27;小明&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;2000-10-20&#x27;</span>,<span class="string">&#x27;湖南永州&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>,<span class="string">&#x27;小红&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1998-08-24&#x27;</span>,<span class="string">&#x27;福建南平&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>,<span class="string">&#x27;小军&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1997-06-18&#x27;</span>,<span class="string">&#x27;四川泸州&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>,<span class="string">&#x27;小聪&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;2001-10-21&#x27;</span>,<span class="string">&#x27;贵州遵义&#x27;</span>);</span><br></pre></td></tr></table></figure></div>

<ul>
<li>需求：</li>
</ul>
<ol>
<li>向学生表中添加1条记录代码(增)</li>
<li>将id为2的用户，姓名更新为”红红”，性别换成女(改)</li>
<li>将id为4的学员删除(删)</li>
</ol>
<ul>
<li>代码：</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dfbz.demo;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.dfbz.utils.JdbcUtils;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.Date;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>: 实现增删改操作</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo07</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// preparedStatement向学生表中添加一条记录</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">//创建连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JdbcUtils.getConnection();</span><br><span class="line">        <span class="comment">//创建预编译语句对象</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(<span class="string">&quot;INSERT into student VALUES (null,?,?,?,?)&quot;</span>);</span><br><span class="line">        <span class="comment">//设置参数替换占位符</span></span><br><span class="line">        ps.setString(<span class="number">1</span>, <span class="string">&quot;小陈&quot;</span>);</span><br><span class="line">        ps.setString(<span class="number">2</span>, <span class="string">&quot;女&quot;</span>);</span><br><span class="line">        ps.setDate(<span class="number">3</span>, Date.valueOf(<span class="string">&quot;1987-02-10&quot;</span>));   <span class="comment">//静态方法，将一个字符串转成日期类型</span></span><br><span class="line">        ps.setString(<span class="number">4</span>, <span class="string">&quot;安徽宣城&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行SQL语句</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> ps.executeUpdate();</span><br><span class="line">        <span class="comment">//关闭资源</span></span><br><span class="line">        JdbcUtils.close(conn, ps);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//输出影响的行数</span></span><br><span class="line">        System.out.println(<span class="string">&quot;影响了&quot;</span> + i + <span class="string">&quot;行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将id为1的用户,姓名更新为&quot;明明&quot;,性别换成女(改),出生日期改为&quot;1994-03-19&quot;,地址改为&quot;陕西汉中&quot;</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">//创建连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JdbcUtils.getConnection();</span><br><span class="line">        <span class="comment">//创建预编译语句对象</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(<span class="string">&quot;UPDATE student set name=?, gender=?,birthday=?,address=? where id=?&quot;</span>);</span><br><span class="line">        <span class="comment">//设置参数替换占位符</span></span><br><span class="line">        ps.setString(<span class="number">1</span>, <span class="string">&quot;明明&quot;</span>);</span><br><span class="line">        ps.setString(<span class="number">2</span>, <span class="string">&quot;女&quot;</span>);</span><br><span class="line">        ps.setDate(<span class="number">3</span>, Date.valueOf(<span class="string">&quot;1994-03-19&quot;</span>));</span><br><span class="line">        ps.setString(<span class="number">4</span>, <span class="string">&quot;陕西汉中&quot;</span>);</span><br><span class="line">        ps.setInt(<span class="number">5</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行SQL语句</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> ps.executeUpdate();</span><br><span class="line">        <span class="comment">//关闭资源</span></span><br><span class="line">        JdbcUtils.close(conn, ps);</span><br><span class="line">        <span class="comment">//输出影响的行数</span></span><br><span class="line">        System.out.println(<span class="string">&quot;影响了&quot;</span> + i + <span class="string">&quot;行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将id为4的学员删除</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">//创建连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JdbcUtils.getConnection();</span><br><span class="line">        <span class="comment">//创建预编译语句对象</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(<span class="string">&quot;DELETE FROM student where id=?&quot;</span>);</span><br><span class="line">        <span class="comment">//设置参数替换占位符</span></span><br><span class="line">        ps.setInt(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line">        <span class="comment">//执行SQL语句</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> ps.executeUpdate();</span><br><span class="line">        <span class="comment">//关闭资源</span></span><br><span class="line">        JdbcUtils.close(conn, ps);</span><br><span class="line">        <span class="comment">//输出影响的行数</span></span><br><span class="line">        System.out.println(<span class="string">&quot;影响了&quot;</span> + i + <span class="string">&quot;行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="5-2-4-PreparedStatement执行DQL操作"><a href="#5-2-4-PreparedStatement执行DQL操作" class="headerlink" title="5.2.4 PreparedStatement执行DQL操作"></a>5.2.4 PreparedStatement执行DQL操作</h2><ul>
<li>为什么要封装？</li>
</ul>
<p>因为如果每次都从结果集中取数据，使用起来不方便。而且用完以后必须要关闭连接。如果用户使用的直接是实体类如：Student对象，或集合List对象，用起来会更方便。不用关闭连接，降低了代码的耦合度。</p>
<h3 id="5-2-4-1-表与类之间的关系"><a href="#5-2-4-1-表与类之间的关系" class="headerlink" title="5.2.4.1 表与类之间的关系"></a>5.2.4.1 表与类之间的关系</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/JDBC/93.png"
                     
                ></p>
<p>案例：使用PreparedStatement查询id为1的一条学生数据，封装成一个学生Student对象</p>
<ul>
<li>开发步骤：</li>
</ul>
<ol>
<li>创建一个学生对象</li>
<li>SQL设置占位符</li>
<li>传递参数，替换占位符</li>
<li>将结果封装成一个学生对象</li>
<li>释放资源</li>
<li>使用数据，输出到控制台</li>
</ol>
<p>学生对象：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">package com.dfbz.entity;</span><br><span class="line"></span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @author lscl</span></span><br><span class="line"><span class="comment"> * @version 1.0</span></span><br><span class="line"><span class="comment"> * @intro: </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public class Student &#123;</span><br><span class="line">    private <span class="type">Integer</span> id;</span><br><span class="line">    private String name;</span><br><span class="line">    private String gender;</span><br><span class="line">    private <span class="type">Date</span> birthday;</span><br><span class="line">    private String address;</span><br><span class="line"></span><br><span class="line">    <span class="variable">@Override</span></span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        <span class="keyword">return</span> &quot;Student&#123;&quot; <span class="operator">+</span></span><br><span class="line">                &quot;id=&quot; <span class="operator">+</span> id <span class="operator">+</span></span><br><span class="line">                &quot;, name=&#x27;&quot; <span class="operator">+</span> name <span class="operator">+</span> <span class="string">&#x27;\&#x27;&#x27; +</span></span><br><span class="line"><span class="string">                &quot;, gender=&#x27;</span>&quot; + gender + &#x27;\&#x27;&#x27; +</span><br><span class="line">                &quot;, birthday<span class="operator">=</span>&quot; + birthday +</span><br><span class="line">                &quot;, address<span class="operator">=</span><span class="string">&#x27;&quot; + address + &#x27;</span>\<span class="string">&#x27;&#x27;</span> <span class="operator">+</span></span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Student() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Student(<span class="type">Integer</span> id, String name, String gender, <span class="type">Date</span> birthday, String address) &#123;</span><br><span class="line">        this.id <span class="operator">=</span> id;</span><br><span class="line">        this.name <span class="operator">=</span> name;</span><br><span class="line">        this.gender <span class="operator">=</span> gender;</span><br><span class="line">        this.birthday <span class="operator">=</span> birthday;</span><br><span class="line">        this.address <span class="operator">=</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="type">Integer</span> getId() &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(<span class="type">Integer</span> id) &#123;</span><br><span class="line">        this.id <span class="operator">=</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name <span class="operator">=</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getGender() &#123;</span><br><span class="line">        <span class="keyword">return</span> gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setGender(String gender) &#123;</span><br><span class="line">        this.gender <span class="operator">=</span> gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="type">Date</span> getBirthday() &#123;</span><br><span class="line">        <span class="keyword">return</span> birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setBirthday(<span class="type">Date</span> birthday) &#123;</span><br><span class="line">        this.birthday <span class="operator">=</span> birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getAddress() &#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAddress(String address) &#123;</span><br><span class="line">        this.address <span class="operator">=</span> address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>代码：</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询id为1的一条记录封装成一个学生对象</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="comment">//得到连接对象</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JdbcUtils.getConnection();</span><br><span class="line">    <span class="comment">//得到预编译语句对象</span></span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(<span class="string">&quot;select * from student where id=?&quot;</span>);</span><br><span class="line">    <span class="comment">//设置占位符</span></span><br><span class="line">    ps.setInt(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="comment">//执行SQL语句</span></span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">    <span class="comment">//创建一个学生对象</span></span><br><span class="line">    <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">    <span class="comment">//封装成一个学生对象</span></span><br><span class="line">    <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">        student.setId(rs.getInt(<span class="string">&quot;id&quot;</span>));    <span class="comment">//从结果集中取出值，封装给学生对象</span></span><br><span class="line">        student.setName(rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">        student.setGender(rs.getString(<span class="string">&quot;gender&quot;</span>));</span><br><span class="line">        student.setBirthday(rs.getDate(<span class="string">&quot;birthday&quot;</span>));</span><br><span class="line">        student.setAddress(rs.getString(<span class="string">&quot;address&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//关闭连接对象</span></span><br><span class="line">    JdbcUtils.close(conn, ps, rs);</span><br><span class="line">    System.out.println(student);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li><p>需求： 查询所有的学生类，封装成List&lt;Student&gt;返回</p>
</li>
<li><p>开发步骤：</p>
</li>
</ul>
<ol>
<li>创建一个集合用于封装所有的记录</li>
<li>得到连接对象</li>
<li>得到语句对象，SQL语句没有占位符</li>
<li>每次循环封装一个学生对象</li>
<li>把数据放到集合中</li>
<li>关闭连接</li>
<li>使用数据，循环输出学生对象</li>
</ol>
<ul>
<li>代码：</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findAll</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="comment">//创建集合</span></span><br><span class="line">    List&lt;Student&gt; students = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//创建连接对象</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JdbcUtils.getConnection();</span><br><span class="line">    <span class="comment">//创建预编译语句对象</span></span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(<span class="string">&quot;select * from student&quot;</span>);</span><br><span class="line">    <span class="comment">//查询</span></span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">    <span class="comment">//使用while循环</span></span><br><span class="line">    <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">        <span class="comment">//每次循环创建一个学生对象</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        student.setId(rs.getInt(<span class="string">&quot;id&quot;</span>));    <span class="comment">//从结果集中取出值，封装给学生对象</span></span><br><span class="line">        student.setName(rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">        student.setGender(rs.getString(<span class="string">&quot;gender&quot;</span>));</span><br><span class="line">        student.setBirthday(rs.getDate(<span class="string">&quot;birthday&quot;</span>));</span><br><span class="line">        student.setAddress(rs.getString(<span class="string">&quot;address&quot;</span>));</span><br><span class="line">        <span class="comment">//封装好的学生对象放在集合中</span></span><br><span class="line">        students.add(student);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//关闭连接</span></span><br><span class="line">    JdbcUtils.close(conn, ps, rs);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Student student : students) &#123;</span><br><span class="line">        System.out.println(student);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="5-2-4-2-PreparedStatement小结："><a href="#5-2-4-2-PreparedStatement小结：" class="headerlink" title="5.2.4.2 PreparedStatement小结："></a>5.2.4.2 PreparedStatement小结：</h3><table>
<thead>
<tr>
<th>功能</th>
<th>实现</th>
</tr>
</thead>
<tbody><tr>
<td>得到PreparesStatement对象的方法</td>
<td>通过连接对象创建</td>
</tr>
<tr>
<td>设置占位符的方法</td>
<td>setXxx(占位符位置, 真实值)</td>
</tr>
<tr>
<td>执行DML的方法</td>
<td>executeUpdate()</td>
</tr>
<tr>
<td>执行DQL的方法</td>
<td>executeQuery()</td>
</tr>
</tbody></table>
<h1 id="六、连接池的概述"><a href="#六、连接池的概述" class="headerlink" title="六、连接池的概述"></a>六、连接池的概述</h1><h2 id="6-1-什么是连接池"><a href="#6-1-什么是连接池" class="headerlink" title="6.1 什么是连接池"></a>6.1 什么是连接池</h2><h3 id="6-1-1-JDBC访问数据库时操作Connection对象："><a href="#6-1-1-JDBC访问数据库时操作Connection对象：" class="headerlink" title="6.1.1 JDBC访问数据库时操作Connection对象："></a>6.1.1 JDBC访问数据库时操作Connection对象：</h3><p>每次访问数据库都必须先创建连接，执行完毕以后关闭连接对象。连接对象需要不停的创建，不停的关闭。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/JDBC/92.png"
                     
                ></p>
<h3 id="6-1-2-连接对象的使用问题："><a href="#6-1-2-连接对象的使用问题：" class="headerlink" title="6.1.2 连接对象的使用问题："></a>6.1.2 连接对象的使用问题：</h3><ol>
<li>数据库创建连接通常需要消耗相对较多的资源，创建时间也较长，而每次操作都要重新获取新的连接对象，执行一次操作就把连接关闭，这样数据库连接对象的使用率低。</li>
<li>假设网站一天10万访问量，数据库服务器就需要创建10万次连接，极大的浪费数据库的资源，并且极易造成数据库服务器内存溢出</li>
</ol>
<h3 id="6-1-3-连接池需要解决两个问题"><a href="#6-1-3-连接池需要解决两个问题" class="headerlink" title="6.1.3 连接池需要解决两个问题"></a>6.1.3 连接池需要解决两个问题</h3><ol>
<li>提高创建连接对象的速度</li>
<li>提高连接对象的使用率，每个连接对象应该重复使用</li>
</ol>
<h3 id="6-1-4-连接池的原理图"><a href="#6-1-4-连接池的原理图" class="headerlink" title="6.1.4 连接池的原理图"></a>6.1.4 连接池的原理图</h3><ul>
<li>使用连接池的情况</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/JDBC/91.png"
                     
                ></p>
<h3 id="6-1-5-连接池解决现状问题的原理"><a href="#6-1-5-连接池解决现状问题的原理" class="headerlink" title="6.1.5 连接池解决现状问题的原理"></a>6.1.5 连接池解决现状问题的原理</h3><table>
<thead>
<tr>
<th>连接对象</th>
<th>操作特点</th>
</tr>
</thead>
<tbody><tr>
<td>创建时</td>
<td>程序启动的时候，由应用程序在内存中创建好一定数量的连接对象，放在内存中，这个内存区域就称为连接池，也叫数据源DataSource。</td>
</tr>
<tr>
<td>使用时</td>
<td>访问数据库的时候，直接从连接池中得到一个连接对象就可以了</td>
</tr>
<tr>
<td>关闭时</td>
<td>不是真的关闭连接，而是将连接对象再放回到连接池中。给下一个用户使用</td>
</tr>
</tbody></table>
<h2 id="6-2-数据库连接池API"><a href="#6-2-数据库连接池API" class="headerlink" title="6.2 数据库连接池API"></a>6.2 数据库连接池API</h2><h3 id="6-2-1-数据源接口："><a href="#6-2-1-数据源接口：" class="headerlink" title="6.2.1 数据源接口："></a>6.2.1 数据源接口：</h3><p>javax.sql.DataSource：连接池接口，没有具体实现，由第三方厂商来实现，我们要学会使用连接池。</p>
<h3 id="6-2-2-数据源接口中的方法："><a href="#6-2-2-数据源接口中的方法：" class="headerlink" title="6.2.2 数据源接口中的方法："></a>6.2.2 数据源接口中的方法：</h3><table>
<thead>
<tr>
<th>DataSource接口中的方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Connection getConnection()</td>
<td>从连接池中得到一个连接对象</td>
</tr>
</tbody></table>
<ul>
<li>注：DataSource接口本身只有两个方法，但从父接口继承了一些方法</li>
</ul>
<h3 id="6-2-3-常用连接池参数"><a href="#6-2-3-常用连接池参数" class="headerlink" title="6.2.3 常用连接池参数"></a>6.2.3 常用连接池参数</h3><ul>
<li>所有的参数都不设置，都有默认的值</li>
</ul>
<table>
<thead>
<tr>
<th>常用参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>初始连接数</td>
<td>连接池创建的时候，一开始在连接池中有多少个连接对象</td>
</tr>
<tr>
<td>最大连接数</td>
<td>连接池中最多可以创建多少个连接对象</td>
</tr>
<tr>
<td>最长等待时间</td>
<td>如果连接池中所有的连接对象都在使用，新来的用户等待多久以后抛出异常。单位毫秒</td>
</tr>
<tr>
<td>最长空闲回收时间</td>
<td>如果某个连接对象长时间没有用户使用，多久以后进行回收。不是所有的连接池都支持。</td>
</tr>
</tbody></table>
<h2 id="6-3-自定义连接池"><a href="#6-3-自定义连接池" class="headerlink" title="6.3 自定义连接池"></a>6.3 自定义连接池</h2><h3 id="6-3-1-自定义连接池步骤"><a href="#6-3-1-自定义连接池步骤" class="headerlink" title="6.3.1 自定义连接池步骤"></a>6.3.1 自定义连接池步骤</h3><ol>
<li>编写一个接口：DataSource，包含getConnection()抽象方法</li>
<li>编写实现类实现javax.sql.DataSource接口，实现接口中的方法</li>
<li>定义与连接池相关的参数，如：初始连接池，最大连接数</li>
<li>创建集合用于保存创建好的连接对象，即连接池。</li>
<li>提供获取连接的公共方法</li>
<li>提供关闭连接的公共方法</li>
</ol>
<h3 id="6-3-2-创建数据源MyDataSource类："><a href="#6-3-2-创建数据源MyDataSource类：" class="headerlink" title="6.3.2 创建数据源MyDataSource类："></a>6.3.2 创建数据源MyDataSource类：</h3><ol>
<li>接口：DataSource，包含getConnection()方法，抛出SQLException</li>
<li>类：MyDataSourceDataSource接口</li>
<li>成员对象：private static LinkedList&lt;Connection&gt; pool<br>用于存放连接对象，相当于连接池。</li>
<li>成员变量：initPoolSize初始连接数5，currSize当前连接数0，maxPoolSize最大连接数10</li>
<li>私有成员方法： Connection<br>createConnection()，返回一个连接对象，每创建一个currSize加1.</li>
<li>构造方法：在构造方法中调用方法创建5个连接对象放在集合中，添加到集合末尾。</li>
<li>公有方法：Connection getConnection()方法，三种情况选其中一种。<ol>
<li>如果当前连接池中有连接对象(即size大于0)，则直接从集合中removeFirst()得到一个连接</li>
<li>如果当前连接池没有连接对象(即size小于0)，并且连接数小于最大连接数，调用createConnection()创建连接返回。</li>
<li>如果当前连接数已经等于最大连接数，则抛出SQLException异常。</li>
</ol>
</li>
<li>公有方法：releaseConnection(Connection conn)，把连接对象addLast()放回池中。</li>
</ol>
<ul>
<li>代码：</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dfbz.pool;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLFeatureNotSupportedException;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.logging.Logger;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>: 这是第三方厂商实现连接池的类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyDataSource</span> <span class="keyword">implements</span> <span class="title class_">DataSource</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建连接池的几个属性</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">initPoolSize</span> <span class="operator">=</span> <span class="number">5</span>;       <span class="comment">//初始连接数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">maxPoolSize</span> <span class="operator">=</span> <span class="number">10</span>;       <span class="comment">//最大连接数</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">currSize</span> <span class="operator">=</span> <span class="number">0</span>;           <span class="comment">//当前已经创建了多少个连接对象，计数的作用</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建一个集合，模拟连接池</span></span><br><span class="line">    <span class="keyword">private</span> LinkedList&lt;Connection&gt; pool = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//在构造方法中创建好初始的连接数</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyDataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; initPoolSize; i++) &#123;</span><br><span class="line">            <span class="comment">//创建一个连接对象，并且加到池中最后一个</span></span><br><span class="line">            pool.addLast(createConnection());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//写一个方法创建连接对象</span></span><br><span class="line">    <span class="keyword">private</span> Connection <span class="title function_">createConnection</span><span class="params">()</span>  &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//连接数加1</span></span><br><span class="line">            currSize++;</span><br><span class="line">            <span class="keyword">return</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql:///db04&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到一个连接对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">//如果连接池中有连接对象，直接返回即可</span></span><br><span class="line">        <span class="keyword">if</span> (pool.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//从连接池中取一个元素，返回</span></span><br><span class="line">            <span class="keyword">return</span> pool.removeFirst();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果连接池中没有对象了，但当前连接数小于最大连接数的</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (pool.size() == <span class="number">0</span> &amp;&amp; currSize &lt; maxPoolSize) &#123;</span><br><span class="line">            <span class="keyword">return</span> createConnection();  <span class="comment">//再创建一个新的连接对象</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果已经到达最大连接数</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">SQLException</span>(<span class="string">&quot;已经到达最大连接数：&quot;</span> + maxPoolSize);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭连接的方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">releaseConnection</span><span class="params">(Connection conn)</span> &#123;</span><br><span class="line">        <span class="comment">//将连接对象放回到连接池中</span></span><br><span class="line">        pool.addLast(conn);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Connection <span class="title function_">getConnection</span><span class="params">(String username, String password)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T <span class="title function_">unwrap</span><span class="params">(Class&lt;T&gt; iface)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isWrapperFor</span><span class="params">(Class&lt;?&gt; iface)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PrintWriter <span class="title function_">getLogWriter</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLogWriter</span><span class="params">(PrintWriter out)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLoginTimeout</span><span class="params">(<span class="type">int</span> seconds)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getLoginTimeout</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Logger <span class="title function_">getParentLogger</span><span class="params">()</span> <span class="keyword">throws</span> SQLFeatureNotSupportedException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="6-3-3-测试类使用数据源类："><a href="#6-3-3-测试类使用数据源类：" class="headerlink" title="6.3.3 测试类使用数据源类："></a>6.3.3 测试类使用数据源类：</h3><ol>
<li>创建MyDataSource对象</li>
<li>在类中测试看能否得到1连接对象。</li>
<li>先从连接池中拿10个输出，再拿11个输出，等待2秒出现异常。</li>
<li>当i&#x3D;&#x3D;5时，释放其中一个对象，则可以得到11个连接对象，其中有一个连接是重用的。</li>
</ol>
<ul>
<li>代码：</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dfbz.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.dfbz.pool.MyDataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>: </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo08_MyDataSource</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建数据源(默认初始化10个连接)</span></span><br><span class="line">        <span class="type">MyDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyDataSource</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//从数据源中得到连接对象</span></span><br><span class="line">        <span class="comment">//得到10个连接对象</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">11</span>; i++) &#123;</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> ds.getConnection();</span><br><span class="line">            System.out.println(<span class="string">&quot;得到第&quot;</span> + (i+<span class="number">1</span>) + <span class="string">&quot;个连接&quot;</span> + conn);</span><br><span class="line">            <span class="comment">//释放其中一个</span></span><br><span class="line">            <span class="keyword">if</span> (i==<span class="number">5</span>) &#123;</span><br><span class="line">                <span class="comment">//放到连接池中</span></span><br><span class="line">                ds.releaseConnection(conn);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="七、DRUID连接池"><a href="#七、DRUID连接池" class="headerlink" title="七、DRUID连接池"></a>七、DRUID连接池</h1><h2 id="7-1-DRUID简介"><a href="#7-1-DRUID简介" class="headerlink" title="7.1 DRUID简介"></a>7.1 DRUID简介</h2><p>Druid是阿里巴巴开发的号称为监控而生的数据库连接池，在功能、性能、扩展性方面，都超过其他数据库连接池。Druid已经在阿里巴巴部署了超过600个应用，经过多年生产环境大规模部署的严苛考验。如：一年一度的双十一活动，每年春运的抢火车票。</p>
<p>Druid的下载地址：<a class="link"   target="_blank" rel="noopener" href="https://github.com/alibaba/druid" >https://github.com/alibaba/druid <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>DRUID连接池使用的jar包：<code>druid-1.1.8.jar</code></p>
<h2 id="7-2-DRUID常用的配置参数"><a href="#7-2-DRUID常用的配置参数" class="headerlink" title="7.2 DRUID常用的配置参数"></a>7.2 DRUID常用的配置参数</h2><table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>url</td>
<td>连接字符串</td>
</tr>
<tr>
<td>username</td>
<td>用户名</td>
</tr>
<tr>
<td>password</td>
<td>密码</td>
</tr>
<tr>
<td>driverClassName</td>
<td>驱动库<code>com.mysql.jdbc.Driver</code></td>
</tr>
<tr>
<td>initialSize</td>
<td>初始连接数</td>
</tr>
<tr>
<td>maxActive</td>
<td>最大连接数</td>
</tr>
<tr>
<td>maxWait</td>
<td>最长等待时间</td>
</tr>
</tbody></table>
<h2 id="7-3-DRUID连接池基本使用"><a href="#7-3-DRUID连接池基本使用" class="headerlink" title="7.3 DRUID连接池基本使用"></a>7.3 DRUID连接池基本使用</h2><h3 id="7-3-1-API介绍"><a href="#7-3-1-API介绍" class="headerlink" title="7.3.1 API介绍"></a>7.3.1 API介绍</h3><table>
<thead>
<tr>
<th>DruidDataSourceFactory的方法</th>
<th>方法</th>
</tr>
</thead>
<tbody><tr>
<td>public static DataSource createDataSource(Properties properties)</td>
<td>通过属性对象得到数据源对象</td>
</tr>
</tbody></table>
<h3 id="7-3-2-开发步骤"><a href="#7-3-2-开发步骤" class="headerlink" title="7.3.2 开发步骤"></a>7.3.2 开发步骤</h3><ol>
<li>在src目录下创建一个properties文件，文件名随意，设置上面的参数</li>
<li>加载properties文件的内容到Properties对象中</li>
<li>创建DRUID连接池，使用配置文件中的参数</li>
<li>从DRUID连接池中取出10个连接输出</li>
<li>再从连接池中取出11个连接，并且释放其中的一个。</li>
</ol>
<h3 id="7-3-3-案例演示"><a href="#7-3-3-案例演示" class="headerlink" title="7.3.3 案例演示"></a>7.3.3 案例演示</h3><ul>
<li>属性文件：在src目录下新建一个DRUID配置文件，命名为：druid.properties</li>
<li>参数：初始连接数3个，最大连接池10，最长等待时间2秒</li>
</ul>
<div class="highlight-container" data-rel="Properties"><figure class="iseeu highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 连接字符串</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/db04</span></span><br><span class="line"><span class="comment"># 用户名</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="comment">#初始连接数</span></span><br><span class="line"><span class="attr">initialSize</span>=<span class="string">5</span></span><br><span class="line"><span class="comment">#最大连接数</span></span><br><span class="line"><span class="attr">maxActive</span>=<span class="string">10</span></span><br><span class="line"><span class="comment">#最长等待时间</span></span><br><span class="line"><span class="attr">maxWait</span>=<span class="string">2000</span></span><br></pre></td></tr></table></figure></div>

<ul>
<li>Java代码</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dfbz.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;</span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>: </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo09_Druid</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建一个数据源</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//创建属性对象</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="comment">//src就是类路径所在的目录，从类路径下加载属性文件，转成字节输入流</span></span><br><span class="line">        <span class="comment">//得到输入流</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> Demo09_Druid.class.getResourceAsStream(<span class="string">&quot;/druid.properties&quot;</span>);</span><br><span class="line">        info.load(in);</span><br><span class="line">        <span class="comment">//创建数据源</span></span><br><span class="line">        <span class="type">DataSource</span> <span class="variable">ds</span> <span class="operator">=</span> DruidDataSourceFactory.createDataSource(info);</span><br><span class="line">        <span class="comment">//得到连接对象</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;=<span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> ds.getConnection();</span><br><span class="line">            System.out.println(<span class="string">&quot;第&quot;</span> + i + <span class="string">&quot;个连接对象：&quot;</span> + conn);</span><br><span class="line">            <span class="comment">//释放一个</span></span><br><span class="line">            <span class="keyword">if</span> (i==<span class="number">5</span>) &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>案例效果</li>
</ul>
<ol>
<li>正常得到10个连接</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/JDBC/90.png"
                     
                ></p>
<h1 id="八、连接池工具类"><a href="#八、连接池工具类" class="headerlink" title="八、连接池工具类"></a>八、连接池工具类</h1><h2 id="8-1-创建工具类DataSourceUtils-java"><a href="#8-1-创建工具类DataSourceUtils-java" class="headerlink" title="8.1 创建工具类DataSourceUtils.java"></a>8.1 创建工具类DataSourceUtils.java</h2><ol>
<li>创建私有静态数据源成员变量DataSource ds</li>
<li>在静态代码块中创建连接池<ol>
<li>创建属性对象</li>
<li>从类路径下加载属性文件，得到输入流对象</li>
<li>通过工厂类创建一个数据源</li>
</ol>
</li>
<li>创建公有的得到数据源的方法getDataSource()</li>
<li>创建得到连接对象的方法 getConnection()</li>
<li>创建释放资源的方法 close()</li>
</ol>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dfbz.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>: 数据源的工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataSourceUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DataSource ds;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 在静态代码块中创建数据源对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// 创建属性对象</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="keyword">try</span> (<span class="comment">// 得到输入流</span></span><br><span class="line">             <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> DataSourceUtils.class.getResourceAsStream(<span class="string">&quot;/druid.properties&quot;</span>);) &#123;</span><br><span class="line">            <span class="comment">// 加载到属性对象中</span></span><br><span class="line">            info.load(in);</span><br><span class="line">            ds = DruidDataSourceFactory.createDataSource(info);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到数据源</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> DataSource <span class="title function_">getDataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 从连接池中得到连接对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> ds.getConnection();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 释放资源</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Connection conn, Statement stmt, ResultSet rs)</span> &#123;</span><br><span class="line">        <span class="comment">//关闭结果集</span></span><br><span class="line">        <span class="keyword">if</span> (rs!=<span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭语句对象</span></span><br><span class="line">        <span class="keyword">if</span> (stmt!=<span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                stmt.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭连接对象</span></span><br><span class="line">        <span class="keyword">if</span> (conn!=<span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭连接</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Connection conn, Statement stmt)</span> &#123;</span><br><span class="line">        close(conn, stmt, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="8-2-数据源工具类的使用"><a href="#8-2-数据源工具类的使用" class="headerlink" title="8.2 数据源工具类的使用"></a>8.2 数据源工具类的使用</h2><ul>
<li>需求：表连接查询，查询全部的学生</li>
<li>步骤：</li>
</ul>
<ol>
<li>通过数据源的工具类得到一个连接对象</li>
<li>创建PreparedStatement语句，创建表连接的SQL语句。</li>
<li>执行executeQuery()，查询出结果集，封装成<code>List&lt;Student&gt;</code></li>
<li>通过工具类释放资源</li>
</ol>
<ul>
<li>Java代码：</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dfbz.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.dfbz.entity.Student;</span><br><span class="line"><span class="keyword">import</span> com.dfbz.utils.DataSourceUtils;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lscl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span>: </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo10</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">//多表查询操作</span></span><br><span class="line">        List&lt;Student&gt; stuList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//得到连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DataSourceUtils.getConnection();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//得到预编译的语句对象</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(<span class="string">&quot;select * from student;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//得到结果集</span></span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//封装数据</span></span><br><span class="line">        <span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">gender</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;gender&quot;</span>);</span><br><span class="line">            <span class="type">Date</span> <span class="variable">birthday</span> <span class="operator">=</span> rs.getDate(<span class="string">&quot;birthday&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">address</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;address&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//每个元素封装成Student对象</span></span><br><span class="line">            Student student=<span class="keyword">new</span> <span class="title class_">Student</span>(id,name,gender,birthday,address);</span><br><span class="line"></span><br><span class="line">            stuList.add(student);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭连接</span></span><br><span class="line">        DataSourceUtils.close(conn, ps, rs);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Student student : stuList) &#123;</span><br><span class="line">            System.out.println(student);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

        </div>

        
            <div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> JDBC</li>
        <li><strong>Author:</strong> MinGe</li>
        <li><strong>Created at
                :</strong> 2023-06-10 09:11:00</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2024-11-11 16:23:43
            </li>
        
        <li>
            <strong>Link:</strong> https://redefine.ohevan.com/2023/06/10/JDBC/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/java/">#java</a>&nbsp;
                    </li>
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">#数据库</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2023/09/17/Mongodb/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">Mongodb</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2023/06/10/MySQL%E4%BA%8B%E5%8A%A1/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">MySQL事务</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">JDBC</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81JDBC%E5%85%A5%E9%97%A8"><span class="nav-text">一、JDBC入门</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81Connection%E6%8E%A5%E5%8F%A3%EF%BC%9A"><span class="nav-text">二、Connection接口：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81Statement%E6%8E%A5%E5%8F%A3"><span class="nav-text">三、Statement接口</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B7%A5%E5%85%B7%E7%B1%BBJdbcUtils"><span class="nav-text">四、数据库工具类JdbcUtils</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81SQL%E6%B3%A8%E5%85%A5%E9%97%AE%E9%A2%98"><span class="nav-text">五、SQL注入问题</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E8%BF%9E%E6%8E%A5%E6%B1%A0%E7%9A%84%E6%A6%82%E8%BF%B0"><span class="nav-text">六、连接池的概述</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%83%E3%80%81DRUID%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-text">七、DRUID连接池</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AB%E3%80%81%E8%BF%9E%E6%8E%A5%E6%B1%A0%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="nav-text">八、连接池工具类</span></a></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2022</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">MinGe</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        20 posts in total
                    </span>
                    
                </p>
            
        </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.7.1</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>





    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>








    
<script src="/js/libs/anime.min.js"></script>



<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


</body>
</html>
