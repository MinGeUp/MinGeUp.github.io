<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="MinGe">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/2024/06/08/nginx/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="一、Nginx安装1.1 安装好依赖gcc、gcc-c++、pcre-devel、zlib-devel、openssl、openssl-devel、wget 1yum -y install gcc pcre-devel zlib-devel openssl openssl-devel gcc-c++ wget  1.2 解压nginx1tar -xvf nginx-1.12.2.tar.gz  进">
<meta property="og:type" content="article">
<meta property="og:title" content="Nginx">
<meta property="og:url" content="http://example.com/2024/06/08/Nginx/index.html">
<meta property="og:site_name" content="MinGe">
<meta property="og:description" content="一、Nginx安装1.1 安装好依赖gcc、gcc-c++、pcre-devel、zlib-devel、openssl、openssl-devel、wget 1yum -y install gcc pcre-devel zlib-devel openssl openssl-devel gcc-c++ wget  1.2 解压nginx1tar -xvf nginx-1.12.2.tar.gz  进">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/nginx/1.png">
<meta property="og:image" content="http://example.com/images/nginx/urlhash.png">
<meta property="og:image" content="http://example.com/images/nginx/100.png">
<meta property="og:image" content="http://example.com/images/nginx/101.png">
<meta property="og:image" content="http://example.com/images/nginx/102.png">
<meta property="og:image" content="http://example.com/images/nginx/103.png">
<meta property="og:image" content="http://example.com/images/nginx/104.png">
<meta property="article:published_time" content="2024-06-08T03:13:00.000Z">
<meta property="article:modified_time" content="2024-11-11T08:22:55.333Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/nginx/1.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/redefine-favicon.svg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/redefine-favicon.svg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/redefine-favicon.svg">
    <!--- Page Info-->
    
    <title>
        
            Nginx -
        
        MinGe 博客
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"example.com","root":"/","language":"en"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":1,"number":false,"expand":false,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"dark"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":false,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"MinGe 博客","subtitle":{"text":[],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.7.1","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"resume":{"path":"/2024/11/02/简历/","icon":"fa-regular fa-folder"}},"search":{"enable":false,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":{"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2022/09/25 08:00:00"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
<!--        <span class="swup-progress-icon">-->
<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
<!--        </span>-->
    
</div>



<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container px-6 md:px-12">

    <div class="navbar-content ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                MinGe 博客
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/2024/11/02/%E7%AE%80%E5%8E%86/"
                                        >
                                    <i class="fa-regular fa-folder fa-fw"></i>
                                    RESUME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-screen w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/2024/11/02/%E7%AE%80%E5%8E%86/"
                        >
                            <span>
                                RESUME
                            </span>
                            
                                <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/archives"
                        >
                            <span>Archives</span>
                            <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/tags"
                        >
                            <span>Tags</span>
                            <i class="fa-regular fa-tags fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/categories"
                        >
                            <span>Categories</span>
                            <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                        </a>
                    </li>
                
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">3</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">2</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">19</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container flex relative justify-between box-border w-full h-full">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                <div class="w-full flex items-center pt-6 justify-start">
                    <h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">Nginx</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="/images/redefine-avatar.svg">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">MinGe</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv3</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2024-06-08 11:13</span>
        <span class="mobile">2024-06-08 11:13</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-11-11 16:22:55</span>
            <span class="mobile">2024-11-11 16:22:55</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/java/">java</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h1 id="一、Nginx安装"><a href="#一、Nginx安装" class="headerlink" title="一、Nginx安装"></a>一、Nginx安装</h1><h2 id="1-1-安装好依赖"><a href="#1-1-安装好依赖" class="headerlink" title="1.1 安装好依赖"></a>1.1 安装好依赖</h2><p>gcc、gcc-c++、pcre-devel、zlib-devel、openssl、openssl-devel、wget</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc pcre-devel zlib-devel openssl openssl-devel gcc-c++ wget</span><br></pre></td></tr></table></figure></div>

<h2 id="1-2-解压nginx"><a href="#1-2-解压nginx" class="headerlink" title="1.2 解压nginx"></a>1.2 解压nginx</h2><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf nginx-1.12.2.tar.gz</span><br></pre></td></tr></table></figure></div>

<p>进入<code>nginx-1.12.2</code>目录，进行检出</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/root/nginx</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>–prefix：指定nginx检出目录</p>
</blockquote>
<p>执行make回车、然后执行make install，进行编译</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make install</span><br></pre></td></tr></table></figure></div>

<p>最后会发现&#x2F;root&#x2F;下面会多了一个nginx目录，这个目录就是nginx的执行目录</p>
<h2 id="1-3-nginx命令"><a href="#1-3-nginx命令" class="headerlink" title="1.3 nginx命令"></a>1.3 nginx命令</h2><ul>
<li>.&#x2F;nginx：启动nginx</li>
<li>.&#x2F;nginx -s stop：关闭nginx</li>
<li>.&#x2F;nginx -s reload：重启nginx</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./nginx   #启动nginx</span><br></pre></td></tr></table></figure></div>

<p>此时浏览器访问依旧不行。那是因为Linux的防火墙默认不让外界范围，必须要在防火墙中开放端口</p>
<h2 id="1-4-防火墙开放80端口"><a href="#1-4-防火墙开放80端口" class="headerlink" title="1.4 防火墙开放80端口"></a>1.4 防火墙开放80端口</h2><p>1、查看所有开放的端口</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --list-ports</span><br></pre></td></tr></table></figure></div>

<p>2、开放80端口</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br></pre></td></tr></table></figure></div>

<p>3、重新加载防火墙</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>关闭防火墙：sudo systemctl stop firewalld 本次关闭防火墙（下次启动时防火墙又会开启）</p>
<p>禁用防火墙：sudo systemctl disable firewalld （每次启动时防火墙都关闭。需要重启生效）</p>
<p>查看防火墙状态：sudo systemctl status  firewalld</p>
</blockquote>
<h2 id="1-5-设置nginx启动用户"><a href="#1-5-设置nginx启动用户" class="headerlink" title="1.5 设置nginx启动用户"></a>1.5 设置nginx启动用户</h2><p>nginx启动的用户默认为<code>nobody</code>，我们需要将其改为root（当前登录用户）</p>
<p>编辑<code>/root/nginx/conf/nginx.conf</code></p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">user nobody</span></span><br><span class="line">改为 </span><br><span class="line">user root;			# 当前启动nginx的用户</span><br></pre></td></tr></table></figure></div>

<h2 id="1-6-测试访问"><a href="#1-6-测试访问" class="headerlink" title="1.6 测试访问"></a>1.6 测试访问</h2><p><a class="link"   target="_blank" rel="noopener" href="http://localhost/" >http://localhost/ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h1 id="二、配置文件详解"><a href="#二、配置文件详解" class="headerlink" title="二、配置文件详解"></a>二、配置文件详解</h1><p>完整配置文件</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">user  root;				</span><br><span class="line">worker_processes  1;	</span><br><span class="line"></span><br><span class="line">#error_log  logs/error.log;				</span><br><span class="line">#error_log  logs/error.log  notice;</span><br><span class="line">#error_log  logs/error.log  info;</span><br><span class="line"></span><br><span class="line">#pid        logs/nginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;			</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    #log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">    #                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">    #                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">    #access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">        # redirect server error pages to the static page /50x.html</span><br><span class="line">        #</span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    proxy_pass   http://127.0.0.1;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    root           html;</span><br><span class="line">        #    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">        #    fastcgi_index  index.php;</span><br><span class="line">        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">        #    include        fastcgi_params;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class="line">        # concurs with nginx&#x27;s one</span><br><span class="line">        #</span><br><span class="line">        #location ~ /\.ht &#123;</span><br><span class="line">        #    deny  all;</span><br><span class="line">        #&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       8000;</span><br><span class="line">    #    listen       somename:8080;</span><br><span class="line">    #    server_name  somename  alias  another.alias;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # HTTPS server</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       443 ssl;</span><br><span class="line">    #    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #    ssl_certificate      cert.pem;</span><br><span class="line">    #    ssl_certificate_key  cert.key;</span><br><span class="line"></span><br><span class="line">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class="line">    #    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    #    ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>nginx.conf配置文件主要分为三部分。</p>
<h2 id="2-1-main块"><a href="#2-1-main块" class="headerlink" title="2.1 main块"></a>2.1 main块</h2><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">user  root;			# 工作进程worker所属用户		</span><br><span class="line">worker_processes  1;	</span><br><span class="line">worker_rlimit_nofile 65535;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">error_log  logs/error.log;</span>				</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">error_log  logs/error.log  notice;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">error_log  logs/error.log  info;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">pid        logs/nginx.pid;</span></span><br></pre></td></tr></table></figure></div>

<p>主要包括配置运行 Nginx 服务器的用户（组）、允许生成的 worker process 数，进程 PID 存放路径、日志存放路径和类型以及配置文件的引入等 </p>
<ul>
<li><p><code>user</code>：设置worker进程运行的用户或用户组，默认是nobody用户（注意：nginx启动默认有两个进程，一个为master，另一个为worker）</p>
</li>
<li><p><code>worker_processes</code>：nginx要开启的工作进程数量，一般开启一个即可，如果服务器上配置有多个CPU可适当提高（一般保持和CPU核心数一致即可）</p>
</li>
<li><p><code>worker_rlimit_nofile</code>：nginx单个进程最大的打开文件数</p>
</li>
<li><p><code>pid</code>：指定master进程的存储文件位置</p>
<ul>
<li>查看master进程：</li>
</ul>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef|grep nginx</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/nginx/1.png"
                     
                ></p>
</li>
<li><p><code>error_log</code>：指定错误日志的存放位置</p>
<ul>
<li>格式如下：</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">error_log path [level]</span><br><span class="line">实例：</span><br><span class="line">error_log logs/error.log</span><br><span class="line">error_log logs/error.log debug</span><br><span class="line">error_log logs/error.log notice</span><br><span class="line">error_log logs/error.log info</span><br></pre></td></tr></table></figure></div>

<ul>
<li>日志等级level的值有<code>debug</code>，<code>info</code>，<code>notice</code>， <code>warn</code>，<code>error</code>，<code>crit</code>， <code>alert</code>，<code>emerg</code>，错误等级由低到高，debug等级最低（日志信息最多，但会带来较大的磁盘IO开销），emerg等级最高（日志信息最少） ，一般的日志是由<code> warn | error | crit</code> 这三个场景产生。</li>
</ul>
</li>
</ul>
<h2 id="2-2-events块"><a href="#2-2-events块" class="headerlink" title="2.2 events块"></a>2.2 events块</h2><p>events 块涉及的指令主要影响 Nginx 服务器与用户的网络连接，常用的设置包括是否开启对多 work process下的网络连接进行序列化，是否允许同时接收多个网络连接，选取哪种事件驱动模型来处理连接请求，每个 word process 可以同时支持的最大连接数等。</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">events &#123;</span><br><span class="line">    multi_accept on; </span><br><span class="line">    worker_connections 1024;			</span><br><span class="line">    open_file_cache max=3000 inactive=120s;</span><br><span class="line">    open_file_cache_valid 30s;</span><br><span class="line">    open_file_cache_min_uses 5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li><code>multi_accept</code>：设置一个进程是否同时接受多个网络连接，<strong>默认为off</strong></li>
<li><code>worker_connections</code>：每个进程允许的最大连接数</li>
<li>nginx服务器最大连接数&#x3D; <code>worker_process * worker_connection</code></li>
<li><code>open_file_cache max=3000 inactive=120s</code>：</li>
<li><code>open_file_cache</code>：设置打开文件的缓存数量（worker_rlimit_nofile：设置单个进程打开文件的最大数量）<ul>
<li>max：最大缓存文件数量</li>
<li>inactive：文件在指定时间内未被请求，达到删除缓存条件</li>
</ul>
</li>
<li><code>open_file_cache_valid 30s</code>：30s检查一次文件缓存，如果发现有文件在120s内没有被使用，则清空该文件的缓存</li>
<li><code>open_file_cache_min_uses 5</code>：120s内如果有文件没有使用5次，那么则清空该文件的缓存</li>
</ul>
<h2 id="2-3-http块"><a href="#2-3-http块" class="headerlink" title="2.3 http块"></a>2.3 http块</h2><p>http 模块主要定义代理、缓存和日志定义等功能。</p>
<h3 id="2-3-1-http-全局配置"><a href="#2-3-1-http-全局配置" class="headerlink" title="2.3.1 http 全局配置"></a>2.3.1 http 全局配置</h3><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">http&#123;</span><br><span class="line">    include       /root/a.conf;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    #log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">    #                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">    #                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">    #access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line">	tcp_nodelay	on;</span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #gzip  on;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li><code>include</code>：加载其他位置的nginx配置文件（互补配置）</li>
<li><code>default_type</code>：当服务器未识别请求资源的类型时，默认以该类型响应</li>
<li><code>keepalive_timeout</code>：HTTP 有一个 KeepAlive 模式，它告诉 web服务器在处理完一个请求后保持这个 TCP 连接的打开状态。若接收到来自客户端的其它请求，服务端会利用这个未被关闭的连接，而不需要再建立一个连接。KeepAlive 在一段时间内保持打开状态，它们会在这段时间内占用资源。占用过多就会影响性能。Nginx 使用 keepalive_timeout 来指定 KeepAlive 的超时时间（timeout）。指定每个 TCP 连接最多可以保持多长时间。Nginx 的默认值是 75 秒，有些浏览器最多只保持 60 秒，所以可以设定为 60 秒。若将它设置为 0，就禁止了 keepalive 连接。</li>
</ul>
<h3 id="2-3-2-server"><a href="#2-3-2-server" class="headerlink" title="2.3.2 server"></a>2.3.2 server</h3><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen        80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #charset koi8-r;</span><br><span class="line"></span><br><span class="line">    #access_log  logs/host.access.log  main;</span><br><span class="line">    </span><br><span class="line">    error_page   404 405 406 /40x.html;</span><br><span class="line">    </span><br><span class="line">    location /40x.html &#123;</span><br><span class="line">    	root html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>listen：监听的端口</li>
<li>server_name：访问的服务名（ip地址）</li>
<li>error_page：错误页面</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">error_page   404 405 406 /40x.html		# 如果出现404 405 406错误则调到40x.html页面处理错误</span><br><span class="line">location /40x.html &#123;					# 来到 html/40x.html处理</span><br><span class="line">	root html;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>tips：error_page处理的是nginx代理时出现的404问题，如nginx已经代理成功到对应的服务器上，因服务器上没有资源而404，则error_page不处理。</p>
</blockquote>
<h4 id="2-3-2-1-location"><a href="#2-3-2-1-location" class="headerlink" title="2.3.2.1 location"></a>2.3.2.1 location</h4><p>语法：</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">location [=|~|~*|^~] /uri/ &#123; … &#125;</span><br></pre></td></tr></table></figure></div>

<p>示例：</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    root   html;</span><br><span class="line">    index  index.html index.htm;</span><br><span class="line">    #alias /etc/www/image/;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>location的uri匹配规则：</p>
<ul>
<li>&#x2F; ：<strong>无修饰符匹配</strong>，代表以 &#x2F; 开头的所有uri都符合</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">location /abc &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">success:</span><br><span class="line">http://baidu.com/abc</span><br><span class="line">http://baidu.com/abc?p=1</span><br><span class="line">http://baidu.com/abc/</span><br><span class="line">http://baidu.com/abc/def</span><br><span class="line">http://baidu.com/abcdef</span><br></pre></td></tr></table></figure></div>

<ul>
<li>&#x3D; ：精确匹配，</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">location = /abc &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">success:</span><br><span class="line">http://baidu.com/abc</span><br><span class="line">http://baidu.com/abc?p=1</span><br><span class="line"></span><br><span class="line">error:</span><br><span class="line">http://baidu.com/abc/</span><br><span class="line">http://baidu.com/abc/def</span><br><span class="line">http://baidu.com/abcdef</span><br></pre></td></tr></table></figure></div>

<ul>
<li>~ ：匹配正则表达式（区分大小写）</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">location ~ \.(jpg|png|bmp)$ &#123;</span><br><span class="line">	proxy_pass http://localhost:8080/images;</span><br><span class="line">&#125;</span><br><span class="line">success:</span><br><span class="line">http://baidu.com/1.bmp</span><br><span class="line"></span><br><span class="line">error:</span><br><span class="line">http://baidu.com/1.Bmp</span><br></pre></td></tr></table></figure></div>

<ul>
<li>~* ：匹配正则表达式（不区分大小写）</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">location ~* \.(jpg|png|bmp)$ &#123;</span><br><span class="line">	proxy_pass http://localhost:8080;</span><br><span class="line">&#125;</span><br><span class="line">success:</span><br><span class="line">http://baidu.com/1.bmp</span><br><span class="line">http://baidu.com/1.Bmp</span><br><span class="line"></span><br><span class="line">error:</span><br><span class="line">http://baidu.com/abc/1.bmp</span><br><span class="line">http://baidu.com/abc/1.Bmp</span><br></pre></td></tr></table></figure></div>

<p><a class="link"   target="_blank" rel="noopener" href="http://192.168.133.130/1.png" >http://192.168.133.130/1.png <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<ul>
<li>^~ ：类似于无修饰符匹配，但优先级比无修饰符高（<strong>本质上也是一种无修饰符匹配，不可以和无匹配修饰符同时使用</strong>）</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">location = /1.png &#123;				# 1</span><br><span class="line">	root /root/html/a/;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location  ^~ /1.png &#123;			# 2</span><br><span class="line">	root /root/html/b/;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location ~ \.(png)$ &#123;			# 3</span><br><span class="line">	root /root/html/c/;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location /1.png &#123;				# 4		</span><br><span class="line">	root /root/html/d/;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location / &#123;					# 5</span><br><span class="line">	root /root/html;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>测试：访问<a class="link"   target="_blank" rel="noopener" href="http://192.168.10.131/1.png%EF%BC%8C%E6%9F%A5%E7%9C%8B%E4%BC%98%E5%85%88%E7%BA%A7%E3%80%82" >http://192.168.10.131/1.png，查看优先级。 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="http://192.168.18.132/1.png" >http://192.168.18.132/1.png <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>查找顺序和优先级</strong></p>
<p><strong>1：带有“&#x3D;“的精确匹配优先</strong></p>
<p><strong>2：^~ 匹配</strong></p>
<p><strong>3：正则表达式匹配</strong></p>
<p><strong>4：无修饰符匹配（精确匹配）</strong></p>
<p><strong>5：无修饰符匹配（模糊匹配）</strong></p>
<h3 id="2-3-3-root和alias的区别："><a href="#2-3-3-root和alias的区别：" class="headerlink" title="2.3.3 root和alias的区别："></a>2.3.3 root和alias的区别：</h3><ul>
<li>root：访问的资源去哪个目录下寻找</li>
<li>index：首页配置</li>
<li>alias：别名配置</li>
</ul>
<p><a class="link"   target="_blank" rel="noopener" href="http://localhost/abc/1.png" >http://localhost/abc/1.png <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">location /abc/ &#123;</span><br><span class="line">    alias /etc/image/;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">如果访问abc目录下的文件,则去/etc/image 目录下找</span></span><br><span class="line"></span><br><span class="line">location /abc/ &#123;</span><br><span class="line">    root /etc/image/;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">如果访问abc目录下的文件,则去/etc/image/abc 目录下找</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>Tips：alias后面必须要用”&#x2F;“结尾！否则会找不到文件，root可有可无</p>
</blockquote>
<h1 id="三、反向代理"><a href="#三、反向代理" class="headerlink" title="三、反向代理"></a>三、反向代理</h1><h2 id="3-1-准备工作"><a href="#3-1-准备工作" class="headerlink" title="3.1 准备工作"></a>3.1 准备工作</h2><p>在线下载jdk并安装：</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install java-1.8.0-openjdk</span><br></pre></td></tr></table></figure></div>

<p>准备两个tomcat，一个为8080端口，另一个为8081端口</p>
<p>在防火墙中开放8080、8081端口</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=8080/tcp --permanent</span><br><span class="line">firewall-cmd --zone=public --add-port=8081/tcp --permanent</span><br></pre></td></tr></table></figure></div>

<p>启动两台tomcat：</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./catalina.sh run</span><br></pre></td></tr></table></figure></div>

<h2 id="3-2-示例一"><a href="#3-2-示例一" class="headerlink" title="3.2 示例一"></a>3.2 示例一</h2><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;				#监听的端口</span><br><span class="line">    server_name  192.168.170.128;		</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://192.168.170.128:8080;		# 代理的端口</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="3-3-示例二"><a href="#3-3-示例二" class="headerlink" title="3.3 示例二"></a>3.3 示例二</h2><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;				#监听的端口</span><br><span class="line">    server_name  192.168.170.128;		</span><br><span class="line"></span><br><span class="line">    location /list &#123;</span><br><span class="line">        proxy_pass http://192.168.170.128:8080;		# 代理的端口</span><br><span class="line">    &#125;</span><br><span class="line">    location /item &#123;</span><br><span class="line">        proxy_pass http://192.168.170.128:8081;		# 代理的端口</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>1）代理静态资源</p>
<p>2）协调应用服务器（Tomcat）</p>
<h1 id="四、负载均衡"><a href="#四、负载均衡" class="headerlink" title="四、负载均衡"></a>四、负载均衡</h1><p>nginx负载均衡内置有4总算法，分别为轮询、权重（weight）、hash、fair等，其中<strong>轮询</strong>是nginx默认使用的算法</p>
<p>准备工作：</p>
<p>在两个tomcat下的webapps下创建aaa文件夹，并且创建index.html</p>
<h2 id="4-1-轮询"><a href="#4-1-轮询" class="headerlink" title="4.1 轮询"></a>4.1 轮询</h2><p>默认选项，当weight不指定时，各服务器weight相同，每个请求按时间顺序逐一分配到不同的后端服务器</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">upstream myserver&#123;</span><br><span class="line">    server 192.168.170.128:8080;</span><br><span class="line">    server 192.168.170.128:8081;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  192.168.170.128;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://myserver;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>访问：<a class="link"   target="_blank" rel="noopener" href="http://192.168.170.128/aaa" >http://192.168.170.128/aaa <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>查看是否有轮询效果。</p>
<h2 id="4-2-权重（weight）"><a href="#4-2-权重（weight）" class="headerlink" title="4.2 权重（weight）"></a>4.2 权重（weight）</h2><p>指定轮询几率，weight和访问比率成正比，用于后端服务器性能不均的情况。每台服务器的<strong>默认weight为1</strong></p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">upstream myserver&#123;</span><br><span class="line">    server 192.168.170.128:8080 weight=2;</span><br><span class="line">    server 192.168.170.128:8081;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  192.168.170.128;</span><br><span class="line"></span><br><span class="line">    #charset koi8-r;</span><br><span class="line"></span><br><span class="line">    #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://myserver;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="4-3-哈希（ip-hash）"><a href="#4-3-哈希（ip-hash）" class="headerlink" title="4.3 哈希（ip_hash）"></a>4.3 哈希（ip_hash）</h2><p>每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器，<strong>可以解决session不能跨服务器的问题。</strong></p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">upstream myserver&#123;</span><br><span class="line">	ip_hash;</span><br><span class="line">    server 192.168.170.128:8080;</span><br><span class="line">    server 192.168.170.128:8081;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  192.168.170.128;</span><br><span class="line"></span><br><span class="line">    #charset koi8-r;</span><br><span class="line"></span><br><span class="line">    #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://myserver;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="4-4-url-hash"><a href="#4-4-url-hash" class="headerlink" title="4.4 url_hash"></a>4.4 url_hash</h2><p>根据url的hash结果分配，同一个url访问的是同一台机器。一般用于下载服务器</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">upstream myserver&#123;</span><br><span class="line">	hash $request_uri;</span><br><span class="line">    server 192.168.170.128:8080;</span><br><span class="line">    server 192.168.170.128:8081;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  192.168.170.128;</span><br><span class="line"></span><br><span class="line">    #charset koi8-r;</span><br><span class="line"></span><br><span class="line">    #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://myserver;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>url_hash在早期的nginx版本中，nginx内部并没有集成url_hash功能，需要用户自己手动安装url_hash模块</p>
<p>下载地址：<a class="link"   target="_blank" rel="noopener" href="https://github.com/evanmiller/nginx_upstream_hash" >https://github.com/evanmiller/nginx_upstream_hash <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</blockquote>
<p>当你服务端的一个特定url路径会被同一个用户连续访问时，如果负载均衡策略还是轮询的话，那该用户的多次访问会被打到各台服务器上，这显然并不高效（会建立多次http链接等问题）。甚至考虑一种极端情况，用户需要分片上传文件到服务器下，然后再由服务器将分片合并，这时如果用户的请求到达了不同的服务器，那么分片将存储于不同的服务器目录中，导致无法将分片合并。所以，此类场景可以考虑采用nginx提供的ip_hash策略。既能满足每个用户请求到同一台服务器，又能满足不同用户之间负载均衡。</p>
<h2 id="4-5-fair"><a href="#4-5-fair" class="headerlink" title="4.5 fair"></a>4.5 fair</h2><p>fair采用的不是内建负载均衡使用的轮换的均衡算法，而是可以根据页面大小、加载时间长短智能的进行负载均衡。</p>
<h3 id="4-5-1-安装fair模块"><a href="#4-5-1-安装fair模块" class="headerlink" title="4.5.1 安装fair模块"></a>4.5.1 安装fair模块</h3><p>fair模块属于第三方插件，功能没有集成在nginx中，因此要额外安装。</p>
<p>1）安装unzip插件</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install unzip</span><br></pre></td></tr></table></figure></div>

<p>2）解压nginx-upstream-fair-master.zip</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip nginx-upstream-fair-master.zip</span><br></pre></td></tr></table></figure></div>

<p><strong>一、在安装nginx时就指定安装fair模块：</strong></p>
<p>1）进入nginx解压目录（nginx-1.12.2），检出文件</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/root/nginx --add-module=/root/nginx-upstream-fair-master </span><br></pre></td></tr></table></figure></div>

<p>2）编译和安装</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make install</span><br></pre></td></tr></table></figure></div>

<p><strong>二、已经安装过nginx后安装fair模块：</strong></p>
<p>1）进入nginx解压目录（nginx-1.12.2）重新检出文件（地址和原来检出的时候一致）</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/root/nginx --add-module=/root/nginx-upstream-fair-master</span><br></pre></td></tr></table></figure></div>

<p>2）编译（只需要编译，如果安装会覆盖原来的）</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make</span><br></pre></td></tr></table></figure></div>

<p>3）覆盖原来的nginx可执行命令</p>
<p>在当前目录中（nginx-1.12.2目录），进入objs目录，替换掉原来nginx的可执行文件</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost nginx-1.12.2]# cd objs/</span><br><span class="line">[root@localhost objs]# ls</span><br><span class="line">addon  autoconf.err  Makefile  nginx  nginx.8  ngx_auto_config.h  ngx_auto_headers.h  ngx_modules.c  ngx_modules.o  src  </span><br><span class="line">[root@localhost objs]# cp nginx /root/nginx/sbin/</span><br><span class="line">cp：是否覆盖&quot;/root/nginx/sbin/nginx&quot;？ y</span><br></pre></td></tr></table></figure></div>

<h3 id="4-5-2-使用fair模块"><a href="#4-5-2-使用fair模块" class="headerlink" title="4.5.2 使用fair模块"></a>4.5.2 使用fair模块</h3><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">upstream myserver&#123;</span><br><span class="line">	fair;</span><br><span class="line">    server 192.168.170.128:8080;</span><br><span class="line">    server 192.168.170.128:8081;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  192.168.170.128;</span><br><span class="line"></span><br><span class="line">    #charset koi8-r;</span><br><span class="line"></span><br><span class="line">    #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://myserver;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="4-6-常用配置"><a href="#4-6-常用配置" class="headerlink" title="4.6 常用配置"></a>4.6 常用配置</h2><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">http&#123;</span><br><span class="line"><span class="meta prompt_">	# </span><span class="language-bash">resolver 10.10.8.1;</span></span><br><span class="line"></span><br><span class="line">    upstream myserver1&#123;</span><br><span class="line">        server 192.168.170.128:8080 weight=3;</span><br><span class="line">        server 192.168.170.128:8081 weight=2;</span><br><span class="line">        server 192.168.170.128:8082 down;</span><br><span class="line">        server 192.168.170.128:8083 max_conns=1000;</span><br><span class="line">        server 192.168.170.128:8084 weight=2 max_fails=3 fail_timeout=60;</span><br><span class="line">        server 192.168.170.128:8085 backup;</span><br><span class="line">    &#125;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  192.168.170.128;</span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass http://myserver1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>resolve：将server中配置的域名，使用指定域名解析器解析。</li>
<li>weight：权重，默认为1</li>
<li>backup：备份服务器，其他服务器都挂了之后才会生效</li>
<li>down：设置当前服务器不可用（不会被分配请求）</li>
<li>max_conns：设置服务器的最大连接数量，数量达到后，将不会有请求分配到该服务器，默认为0，代表不限制连接数</li>
<li>max_fails：设置服务器运行请求连接失败的次数，超过该次数后，在fail_timeout时间内，不会有请求分配此服务器，默认为1</li>
<li>fail_timeout：服务器到达max_fails次失败请求后，在fail_timeout时间内，nginx不会将新的请求分配到此服务器</li>
<li>backup：备用服务器，当以上的所有服务器都不可用时，此服务器提供服务；</li>
</ul>
<h2 id="4-7-总结"><a href="#4-7-总结" class="headerlink" title="4.7 总结"></a>4.7 总结</h2><h3 id="4-7-1-轮询"><a href="#4-7-1-轮询" class="headerlink" title="4.7.1 轮询"></a>4.7.1 轮询</h3><ul>
<li>概念</li>
</ul>
<p>nginx默认的负载均衡机制，将请求轮询派发给每个服务器</p>
<h3 id="4-7-2-权重"><a href="#4-7-2-权重" class="headerlink" title="4.7.2 权重"></a>4.7.2 权重</h3><ul>
<li>概念</li>
</ul>
<p>给不同的web服务器分配不同的权重，默认每台服务器的权重为1，权重越高，访问几率越大</p>
<h3 id="4-7-3-ip-hash"><a href="#4-7-3-ip-hash" class="headerlink" title="4.7.3 ip_hash"></a>4.7.3 ip_hash</h3><ul>
<li>概念</li>
</ul>
<p>为每一个ip地址都计算出一个hash值，nginx根据此hash值选择代理到哪台服务器，由于每一客户端的ip不易变动，因此可以解决集群环境下的session共享问题。</p>
<ul>
<li>应用场景<ul>
<li>1）当服务端的某个资源被同一客户端多次访问时，如果使用的负载均衡策略还是轮询的话，那么该用户会被轮询到各台服务器，造成资源浪费（会建立多次http连接，keepalive时间）</li>
<li>2）在作用于文件传输时，如果采用的是断点续传方式，那么则会导致文件最终上传失败。</li>
</ul>
</li>
</ul>
<h3 id="4-7-4-url-hash"><a href="#4-7-4-url-hash" class="headerlink" title="4.7.4 url_hash"></a>4.7.4 url_hash</h3><ul>
<li>概念</li>
</ul>
<p>为每一个访问的url都计算出一个hash值，nginx根据此hash值选择代理到哪台服务器</p>
<ul>
<li>应用场景<ul>
<li>缓存集群下载</li>
</ul>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/nginx/urlhash.png"
                     
                ></p>
<h3 id="4-7-5-fair"><a href="#4-7-5-fair" class="headerlink" title="4.7.5 fair"></a>4.7.5 fair</h3><ul>
<li>概念</li>
</ul>
<p>nginx根据web服务器的响应时间来选择代理到哪台服务器（压力小的服务器优先选择）</p>
<blockquote>
<p>Tips：fair功能属于第三方模块，需要手动安装</p>
</blockquote>
<h1 id="五、动静分离"><a href="#五、动静分离" class="headerlink" title="五、动静分离"></a>五、动静分离</h1><p>Nginx 动静分离简单来说就是把动态跟静态请求分开，不能理解成只是单纯的把动态页面和静态页面物理分离。严格意义上说应该是动态请求跟静态请求分开，可以理解成使用 Nginx处理静态页面，Tomcat 处理动态页面。动静分离从目前实现角度来讲大致分为两种。 </p>
<p>&#x3D;&#x3D;<strong>1）纯粹把静态文件独立成单独的域名，放在独立的服务器上，也是目前主流推崇的方案；</strong>&#x3D;&#x3D;  </p>
<p>2）动态跟静态文件混合在一起发布，通过 nginx 来分开。</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">location /dynamic/ &#123;				# 如果是dynamic下的请求,就代理到后台服务器</span><br><span class="line">    proxy_pass http://myserver;		# 动态资源</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location /static/ &#123;				# 如果是static下的请求代理到服务器的/root/data/static目录下</span><br><span class="line">	root   /root/data/;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location /images/ &#123;				# 如果是image下的请求代理到服务器的/root/data/image目录下</span><br><span class="line">    root /root/data/;		</span><br><span class="line">    autoindex on;				# 是否以列表展示文件</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="六、keepalived搭建高可用集群"><a href="#六、keepalived搭建高可用集群" class="headerlink" title="六、keepalived搭建高可用集群"></a>六、keepalived搭建高可用集群</h1><h2 id="6-1-高可用集群"><a href="#6-1-高可用集群" class="headerlink" title="6.1 高可用集群"></a>6.1 高可用集群</h2><p>我们在后台搭建了Tomcat集群，使用Nginx做负载均衡处理，这就意味着Nginx是所有请求的”入口“，那么万一Nginx服务器出现故障，那么整个系统将会处于瘫痪过程，我们希望我们系统可以存在一台”备用“Nginx服务器，万一主工作服务器（主服务器）出现故障后，那么备份服务器可以顶替主服务器继续工作，保证我们的系统不会瘫痪，达到系统的高可用效果。</p>
<p>如图：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/nginx/100.png"
                     
                ></p>
<h2 id="6-2-keepalived安装"><a href="#6-2-keepalived安装" class="headerlink" title="6.2 keepalived安装"></a>6.2 keepalived安装</h2><p>1）在线下载安装</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install keepalived</span><br></pre></td></tr></table></figure></div>

<p>2）查看keepalived配置文件，<code>/etc/keepalived/keepalived.conf</code></p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">vrrp_script check_ng &#123;</span><br><span class="line">       script &quot;/root/nginx_check.sh&quot;		# 检测脚本</span><br><span class="line">       interval 2 							# 间隔执行时间</span><br><span class="line">&#125;</span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state MASTER				# 标注是工作状态(master)还是备份状态(backup),路由器组不可以重名</span><br><span class="line">    interface ens33				# 网卡</span><br><span class="line">    virtual_router_id 6			# 虚拟路由标志,同组的virtual_router_id应该保持一致,主备机保持一致</span><br><span class="line">    priority 100				# 设置本节点的优先级,一般master节点较高 (最大值为255)</span><br><span class="line">    advert_int 1				# master与backup同步检查的时间间隔</span><br><span class="line">    master_down_interval 10 	# 检测master多久没有发送心跳过来才认为master节点已经宕机(备份路由器组取集群备份服务器中的最小值)</span><br><span class="line"></span><br><span class="line">    virtual_ipaddress &#123;	</span><br><span class="line">        192.168.88.188			# 虚拟ip</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;				# 启动检测脚本</span><br><span class="line">		check_ng				# 脚本名称</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>检测脚本</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">A=`ps -C nginx --no-header |wc -l`</span><br><span class="line">if [ $A -eq 0 ];then</span><br><span class="line"> /root/nginx/sbin/nginx</span><br><span class="line"></span><br><span class="line"> if [ `ps -C nginx --no-header |wc -l` -eq 0 ];then</span><br><span class="line">	killall keepalived</span><br><span class="line"> fi</span><br><span class="line">fi</span><br></pre></td></tr></table></figure></div>

<ul>
<li>安装killall命令</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install psmisc</span><br></pre></td></tr></table></figure></div>

<ul>
<li>关闭selinux（关闭限制进程访问的资源）</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">临时关闭selinux</span></span><br><span class="line">setenforce 0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">永久关闭selinux(需要重启服务器)</span></span><br><span class="line">sed -i &quot;s/^SELINUX=.*/SELINUX=disabled/g&quot; /etc/selinux/config</span><br></pre></td></tr></table></figure></div>

<ul>
<li>授权</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod u+x /root/nginx_check.sh /root/keepalived_start.sh /root/keepalived_stop.sh /root/start.sh /root/stop.sh</span><br></pre></td></tr></table></figure></div>

<h2 id="6-3-keepalived简介"><a href="#6-3-keepalived简介" class="headerlink" title="6.3 keepalived简介"></a>6.3 keepalived简介</h2><p>keepalived是集群管理中保证集群高可用的一个服务软件，<strong>用来防止单点故障。</strong></p>
<p>keepalived是以VRRP协议为实现基础的，VRRP全称Virtual Router Redundancy Protocol，即<strong>虚拟路由冗余协议</strong>。其作用是检测服务器的状态，如果有一台服务器宕机，或工作出现故障，Keepalived将检测到，并将有故障的服务器从系统中剔除，同时使用其他服务器代替该服务器的工作，当服务器工作正常后Keepalived自动将服务器加入到服务器群中，这些工作全部自动完成，不需要人工干涉，需要人工做的只是修复故障的服务器。</p>
<h2 id="6-4-keepalived-工作原理"><a href="#6-4-keepalived-工作原理" class="headerlink" title="6.4 keepalived 工作原理"></a>6.4 keepalived 工作原理</h2><p>VRRP（Virtual Router Redundancy Protocol）虚拟路由冗余协议是一种容错的主备模式的协议，当网络设备发生故障时，可以不影响主机之间通信情况下进行设备切换，并且相对用户切换过程时透明的（用户无感知）。</p>
<p>路由器（安装了Keepalived的机器）开启VRRP功能后，会根据优先级确定自己在备份组中的角色。<strong>优先级高的路由器成为主用路由器</strong>，优先级低的成为备用路由器。主路由器拥有<strong>虚拟IP</strong>与虚拟MAC，实现各种网络功能，并发送VRRP通告报文，通知备用路由器组内的其他路由器自己工作正常；备用路由器则启动定时器等待通告报文。</p>
<h3 id="6-4-1-抢占模式"><a href="#6-4-1-抢占模式" class="headerlink" title="6.4.1 抢占模式"></a>6.4.1 抢占模式</h3><p>当备份路由器组长时间（master_down_interval）未接收到master节点的VRRP报文后，备份路由器组则认为master节点已经无法正常提供服务（宕机），那么备份路由器组则会推选出一个<strong>优先级较高</strong>的backup节点（根据配置文件），作为主节点继续提供服务，当后续master节点（原来的）恢复正常后，备份路由器组接收到原来master节点的VRRP报文则认为master节点恢复正常，backup节点则回到备份路由器组，由master节点提供服务。</p>
<p>当备用路由器组收到VRRP通告报文后，会将自己的优先级与通告报文中的优先级进行比较。如果大于通告报文中的优先级，则成为主用路由器；否则将保持备用状态。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/nginx/101.png"
                     
                ></p>
<p><strong>VRRP选举机制</strong></p>
<ol>
<li>虚拟IP拥有者，如果某台路由器的IP地址与虚拟路由器的VIP地址一致，那么这台就会被选为主用路由器。</li>
<li><strong>优先级较高者，如果没有虚拟IP拥有者，优先级数值大的路由器会被选举出，优先级范围0~255。</strong></li>
<li>IP地址较大者，如果优先级一样高，IP地址数值大的路由器会被选举出。</li>
</ol>
<blockquote>
<p>在抢占模式中，优先级高的为master节点，state只是作为标注作用，并非真正意义上的master节点，具体的选举要看优先级</p>
</blockquote>
<h3 id="6-4-2-非抢占模式"><a href="#6-4-2-非抢占模式" class="headerlink" title="6.4.2 非抢占模式"></a>6.4.2 非抢占模式</h3><p>在非抢占模式下，所有的节点都为backup，&#x3D;&#x3D;<strong>先启动的先提供服务（Master）</strong>&#x3D;&#x3D;，后面的按照优先级顺序提供服务。主要注意的是，如果第一个提供服务的节点（Master）挂了，那么后续优先级高的将出来提供服务，当原来的”Master”节点又恢复正常之后，<strong>不会将服务切换为原来的”Master”节点提供</strong>，而是继续由现在的服务器节点提供服务。省去了当master节点恢复正常后，本来正常提供的服务节点backup需要将vip（虚拟ip）迁移到master节点的切换操作。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/nginx/102.png"
                     
                ></p>
<p>第一个启动的节点为master节点，后面启动的按照优先级分配。优先级高的作为下一个备选master节点。</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">vrrp_script check_ng &#123;</span><br><span class="line">	script &quot;/root/nginx_check.sh&quot;</span><br><span class="line">	interval 1</span><br><span class="line">&#125;</span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">	nopreempt					# 标志模式为 非抢占模式</span><br><span class="line">	state BACKUP				# 在非抢占模式下,所有的服务器状态都为BACKUP</span><br><span class="line">	interface ens33</span><br><span class="line">	virtual_router_id 6</span><br><span class="line">	priority 120</span><br><span class="line">	advert_int 1</span><br><span class="line">	master_down_interval 10</span><br><span class="line">	virtual_ipaddress &#123;</span><br><span class="line">		192.168.170.188</span><br><span class="line">	&#125;</span><br><span class="line">	track_script &#123;				# 启动检测脚本</span><br><span class="line">		check_ng				# 脚本名称</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>Tips：在非抢占模式下，state标注的为Master节点；</p>
</blockquote>
<h1 id="七、Nginx工作原理"><a href="#七、Nginx工作原理" class="headerlink" title="七、Nginx工作原理"></a>七、Nginx工作原理</h1><h2 id="7-1-Nginx架构图："><a href="#7-1-Nginx架构图：" class="headerlink" title="7.1 Nginx架构图："></a>7.1 Nginx架构图：</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/nginx/103.png"
                     
                ></p>
<p>Master的任务：</p>
<p>读取并解析nginx.conf，管理worker进程，通知worker进程来处理请求。</p>
<p><strong>Nginx是多进程单线程架构</strong></p>
<p><strong>Redis也是多进程单线程</strong></p>
<p>Worker的任务：</p>
<p>Master进程发布消息之后，所有的Worker进程都来”抢夺”这个请求。</p>
<p>每一个Worker进程都可以极大的发挥单核CPU的极限性能</p>
<p>每一个Worker进程都是单线程的，这样避免了线程间的切换，Worker进程数一般和CPU的核数相同。</p>
<p>在nginx.conf中，可修改Worker的进程数量。</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;			# worker的进程数量</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;	# 每个worker进程最多处理的连接数</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure></div>

<p>nginx的每个worker都会发挥出CPU单核的最大性能极限，因此一般将worker进程的数量设置为cpu的核心数量（线程数），设置少了会浪费CPU性能，设置多了会造成多个worker争抢同一个核心的上下文切换带来的损耗。</p>
<h2 id="7-2-计算nginx并发数"><a href="#7-2-计算nginx并发数" class="headerlink" title="7.2 计算nginx并发数"></a>7.2 计算nginx并发数</h2><p>每台nginx能建立的最大连接数为：<code>worker process * worker_connections</code></p>
<p>但这仅仅是连接数，在http1.1中，浏览器的每次请求都会占用两个连接，因此nginx的并发数为：</p>
<p><code>worker process * worker_connections / 2</code></p>
<p>如果nginx作为反向代理服务器，那么nginx出了与浏览器进行连接外，还要与后台的web服务器进行连接（Tomcat）</p>
<p>因此nginx在作为反向代理时，并发量为：<code>worker process * worker_connections / 4</code></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/nginx/104.png"
                     
                ></p>

        </div>

        
            <div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> Nginx</li>
        <li><strong>Author:</strong> MinGe</li>
        <li><strong>Created at
                :</strong> 2024-06-08 11:13:00</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2024-11-11 16:22:55
            </li>
        
        <li>
            <strong>Link:</strong> https://redefine.ohevan.com/2024/06/08/Nginx/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/java/">#java</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2024/10/05/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">分布式事务</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2024/03/23/Dubbo/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">Dubbo</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">Nginx</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81Nginx%E5%AE%89%E8%A3%85"><span class="nav-text">一、Nginx安装</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3"><span class="nav-text">二、配置文件详解</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="nav-text">三、反向代理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="nav-text">四、负载均衡</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB"><span class="nav-text">五、动静分离</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AD%E3%80%81keepalived%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4"><span class="nav-text">六、keepalived搭建高可用集群</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%83%E3%80%81Nginx%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-text">七、Nginx工作原理</span></a></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2022</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">MinGe</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        19 posts in total
                    </span>
                    
                </p>
            
        </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.7.1</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>





    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>








    
<script src="/js/libs/anime.min.js"></script>



<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


</body>
</html>
